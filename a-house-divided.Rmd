---
title: "A House Divided Feels Drafty: Primary Elections and *Intra*-party Coldness"
author: "Rob Lytle"
output: 
  bookdown::pdf_document2:
    number_sections: TRUE
    fig_caption: TRUE
    toc: FALSE
abstract: "How do partisans think about their *own* party? Inter-party animosity has been widely identified by scholars of partisanship and public opinion. Increasingly, Republican and Democratic partisans have come to dislike members of their political out-group. What has been lost in these discussions is an appraisal of individuals' perceptions of and attitudes towards their in-party, which are generally held to be both stable and broadly positive. In this study, I use both existing time-series data and an original survey experiment to explore the role of direct primary elections in shaping partisans' attitudes towards their in-party. I argue that primary election losses cause those who supported the losing candidate to grow colder towards their party. Troublingly, I find no evidence that winners' supporters grow warmer towards their party---the primary serves only to frustrate the losers."
bibliography: references.bib
thanks: "In no particular order, I express my gratitude for the feedback, guidance, and support provided by Hans Hassell, Brad Gomez, Doug Ahler, Jens Grosser, Kai Ou, Bob Jackson, Quintin Beazer, Megan Skowronski, Gaurav Sood, Sarah Warren, Damian Boldt, Taylor Chewning, Olivia VanHousen, Braeden McNulty,  William Thyer, and Kate Peirce. All advice is invaluable and all mistakes are my own."
header-includes:
- \usepackage[margin=1in]{geometry}
- \usepackage{caption}
- \usepackage{multirow}
- \usepackage{amsmath}
- \usepackage{mathrsfs}
- \usepackage{float}
- \usepackage{natbib}
- \bibliographystyle{apsr}
- \usepackage{graphicx}
- \graphicspath{ {../fig/} }
- \usepackage{setspace}
- \usepackage[super]{nth}
- \usepackage{booktabs}
- \usepackage{makecell}
- \usepackage{amsmath}
- \usepackage{dcolumn}
- \usepackage{hyperref}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, fig.width = 6, fig.height = 4, fig.pos = "H", fig.showtext = TRUE)
library(lubridate)
#library(MASS)
library(brglm)
library(modelsummary)
library(marginaleffects)
library(gt)
library(gtsummary)
library(AER)
library(tidyverse) #tidyverse
library(tidymodels)
library(kableExtra) # one way to make tables
library(stargazer) # Another way to make tables (can also output esttab to .tex--examples below)
library(ggExtra)
library(ggridges)
library(gridExtra)
library(ggpubr)
library(cowplot)
library(showtext)
showtext_auto()
set.seed(2001)
#theme_set(theme_minimal())
dodge <- position_dodge(width=0.75)



#font_families_google()
theme_figs <- function(){
#	theme_ipsum_rc() +
	theme_minimal(base_family = "Roboto Mono") +
     theme(
    #   plot.background = element_rect(color = "white"),
       plot.title = element_text(size = rel(1), family = "Roboto Mono"),
       axis.text = element_text(family = "Roboto Mono"),
       axis.title =  element_text(family = "Roboto Condensed"),
    #    axis.title.x = element_text(size = rel(1.2), 
    #    														hjust = .975
    #    														),
    # #   axis.title.x = element_text(size = rel(1.8)), 
    #    axis.title.y = element_text(size =  rel(1.2), 
    #    														hjust = .975
    #    														),
    	 plot.caption = element_text(hjust = 0),
    panel.grid.major.y = element_line(color = "grey")
    #   axis.text.x = element_text(size = rel(1.5)), 
    #   axis.text.y = element_text(size = rel(1.5))
    )
}

theme_set(theme_figs())

```

```{r fonts, eval = TRUE}
font_add_google("Roboto", "Roboto")
font_add_google("Roboto Mono", "Roboto Mono")
font_add_google("Roboto Condensed", "Roboto Condensed")
```

```{r, include = FALSE}
tidy_2020_df <- read_rds("data/tidy-2020.rds")%>%
  select(pid_3,
         pid_7,
         year,
         therm_inparty,
         therm_outparty,
  			 primary_vote_dum,
#         therm_parties_mean,
         weight)%>%
  filter(pid_3 != "Independent")%>%
  glimpse()


cdf_trimmed <- read_rds("data/tidy-cdf.rds")%>%
  filter(year >= 1978)%>%
  select(pid_3,
         pid_7,
  			 primary_vote_dum,
         year,
#         race_4cat,
         therm_inparty,
         therm_outparty,
				 primary_vote_dum,
#         therm_parties_mean,
         weight,
         )%>%
	mutate(therm_inparty = as.numeric(recode(therm_inparty, .default = as.character(therm_inparty), "97" = '100')),
				 therm_outparty = as.numeric(recode(therm_outparty, .default = as.character(therm_outparty), "97" = '100'))) %>%
	  rbind(tidy_2020_df)%>%
  glimpse()

party_fts_ns <- cdf_trimmed%>% # Making a DF of the party-year SD
  filter(pid_3 != "Independent" & year != 2002)%>%
  select(year,
  			 primary_vote_dum,
         weight,
         therm_inparty,
         )%>%
  group_by(year,
  				 primary_vote_dum)%>%
  summarise(sd_in = radiant.data::weighted.sd(therm_inparty, weight, na.rm = TRUE))%>%
	drop_na(primary_vote_dum) %>% 
  glimpse()


below_mct_ns <- cdf_trimmed%>% # MCT = Measure of Central Tendency
#below_mct_ns <- cdf_extended%>% # with 2020
  select(year,
         weight,
         pid_3,
         therm_inparty,
  			 primary_vote_dum)%>%
  filter(pid_3 != "Independent" & year != 2002)%>%
  mutate(above_80_dum = if_else(therm_inparty > 80, 1, 0),
         above_75_dum = if_else(therm_inparty > 75, 1, 0),
         above_mean_sd_dum = if_else(therm_inparty > weighted.mean(therm_inparty, weight, na.rm = TRUE) + radiant.data::weighted.sd(therm_inparty, weight, na.rm = TRUE), 1, 0),
         below_50_dum = if_else(therm_inparty < 50, 1, 0),
#         below_mean_dum = if_else(therm_inparty < weighted.mean(therm_inparty, weight, na.rm = TRUE), 1, 0),
#         below_mean_sd_dum = if_else(therm_inparty < weighted.mean(therm_inparty, weight, na.rm = TRUE) - radiant.data::weighted.sd(therm_inparty, weight, na.rm = TRUE), 1, 0),
#         below_med_dum = if_else(therm_inparty < spatstat::weighted.median(therm_inparty, weight, na.rm = TRUE), 1, 0),
#         below_med_sd_dum = if_else(therm_inparty < spatstat::weighted.median(therm_inparty, weight, na.rm = TRUE) - radiant.data::weighted.sd(therm_inparty, weight, na.rm = TRUE), 1, 0)
)%>%
  glimpse()



n_df_ns <- cdf_trimmed%>% # Making a DF of the party-year SD
  filter(pid_3 != "Independent" & year != 2002)%>%
  select(year,
         weight,
         pid_3,
         therm_inparty,
         therm_outparty)%>%
  group_by(year, pid_3)%>%
  summarise(n = n(),
            mean_in = weighted.mean(therm_inparty, weight, na.rm = TRUE),
            mean_out = weighted.mean(therm_outparty, weight, na.rm = TRUE),
            sd_in = radiant.data::weighted.sd(therm_inparty, weight, na.rm = TRUE),
            sd_out = radiant.data::weighted.sd(therm_outparty, weight, na.rm = TRUE))%>%
  glimpse()


df_for_sampling <- cdf_trimmed%>% # Making a DF of the party-year SD
  filter(pid_3 != "Independent" & year != 2002)%>%
  select(year,
         weight,
         pid_3,
         therm_inparty,
         therm_outparty,
         pid_7
  )%>%
glimpse()


#bootstrapping the SE of the SD
boot_sd_in <- data.frame(boot = 1:500)%>%
  group_by(boot)%>%
  do(sample_n(df_for_sampling, 
              nrow(df_for_sampling),
              replace = TRUE))%>% #creating 100 new datasets of equal size to the original
  group_by(boot,
           year)%>%
  summarise(mean_in = weighted.mean(therm_inparty, weight, na.rm = TRUE),
            sd_in = radiant.data::weighted.sd(therm_inparty, weight, na.rm = TRUE)) %>% 
  group_by(year)%>%
  summarise(se_mean_in = sd(mean_in),
            se_sd_in = sd(sd_in))%>%
  glimpse()

  
party_fts_ns_joined <- left_join(party_fts_ns, boot_sd_in)%>%
#party_fts_ns_joined <- full_join(party_fts_ns, boot_sd_in)%>%
  glimpse()

# 
# df_out_means <- df_primaries%>%
# 	group_by(primary_vote_simple, year, pid_3)%>%
# 	summarize(mean_ft = weighted.mean(therm_outparty, weight, na.rm = TRUE))%>%
# 	glimpse()
# 
# 	###
# 	# Inparty FT
# 	###
# df_in_means <- df_primaries%>%
# 	group_by(primary_vote_simple, year, pid_3)%>%
# 	summarize(mean_ft = weighted.mean(therm_inparty, weight, na.rm = TRUE))%>%
# 	glimpse()
# 
# df_out_means <- df_primaries%>%
# 	group_by(primary_vote_simple, year, pid_3)%>%
# 	summarize(mean_ft = weighted.mean(therm_outparty, weight, na.rm = TRUE))%>%
# 	glimpse()



```

```{r, primary-tab-wrangle, include=FALSE}
df_primaries <- read_rds("data/tidy-primaries.rds")%>%
	rename(prim_vote_simple = primary_vote_simple) %>% 
#	filter(pid_3 != "Independent" & !is.na(prim_vote_simple))%>%
	filter(pid_3 != "Independent")%>%
#	filter(!(pid_3 == "Republican" & prim_vote_simple == "Loser" & year == 2020))%>% # dropping republicans who didn't vote for trump because there are very few.
# 	mutate(prim_vote_simple = recode(prim_vote_simple, .default = levels(prim_vote_simple),
# 																			"Didn't Vote" = "Didn't Vote",
# 																			"Voted in Other Party Primary" = "Voted in Other Primary"))%>%
# #	filter(prim_vote_simple != "Other/Third Party/\n Didn't Vote")%>%
	mutate(prim_vote_simple = factor(prim_vote_simple,
																			levels = c("Winner", "Didn't Vote", "Loser", "Voted in Other Primary")),
				 therm_inparty = if_else(therm_inparty < 0, NA_integer_, therm_inparty),
				 therm_outparty = if_else(therm_outparty < 0, NA_integer_, therm_outparty),
				 ideo_dif_terc = as.factor(ntile(ideo_self_in_dif_std, 3))) %>% 
	glimpse()

ggplot(data = df_primaries, aes(x = ideo_self_in_dif_std, y = therm_inparty)) +
	geom_point(position = position_jitter(width = .1, height = 10, seed = 1234))


gm_3 <- tibble::tribble(
  ~raw,        ~clean,          ~fmt,
  "nobs",      "N",             0,
  "r.squared", "R Sq.", 2,
  "adj.r.squared", "Adj. R Sq.", 2)

# not including ideology var because this  is probably just a proxy for partisanship
cm_3 <- c("prim_vote_simpleLoser" = "Voted for Primary Loser",
					"prim_vote_simpleWinner" = "Voted for Primary Winner",
					"prim_vote_simpleDidn't Vote" = "Didn't Vote in Primary",
					"prim_vote_simpleVoted in Other Primary" = "Voted in Other Primary",
					"ideo_self_prt_std" = "Ideological Extremity",
					"ideo_self_in_dif_std" = "Relative Partisan Extremity",
					"ideo_dif_terc2" = "Rel. Extremity 2",
					"ideo_dif_terc3" = "Rel. Extremity 3",
					"age_group" = "Age Group",
					"male_dum" = "Male",
					"white_dum" = "White",
					"below_35k_dum" = "Income < $35k",
#          "year2012" = "2012",
#          "year2016" = "2016", 
#          "year2020" = "2020",
          "(Intercept)" = "Constant") 

tab_1_df <- df_primaries%>%
  pivot_longer(cols = c(therm_inparty, therm_outparty),
               names_to = "therm_name",
               values_to = "therm_val") %>%
  mutate(therm_name = recode(therm_name,
                             "therm_inparty" =  "In-party",
                             "therm_outparty" = "Out-Party"),
         group_name = paste(therm_name,
                            pid_3,
                            sep = " - "),
         ) %>% 
  group_by(group_name,
           pid_3,
           therm_name)%>%
  nest_by() %>% 
  mutate(fit = list(lm(therm_val ~ prim_vote_simple + age_group + male_dum + white_dum + year + ideo_self_in_dif_std + below_35k_dum, data = data,  weights = weight)),
  			 aug = list(augment(fit)),
  			 tidy = list(tidy(fit)),
  			 glance = list(glance(fit)))
 


df_primaries_test <- read_rds("data/tidy-primaries.rds")%>%
	filter(year == 2016) %>% 
		select(prim_vote_simple = primary_vote_simple,
				 year,
				 pid_3,
				 therm_inparty,
				 case) %>%
		filter(pid_3 == "Republican" | pid_3 == "Democrat") %>%
	glimpse()

fig_3_df <- read_rds("data/tidy-primaries-80-20.rds")%>%
#	filter(year == 2016) %>%  ## WHY IS THIS DIFFERENT in 2016 between the old wrangle and new???????
#fig_3_df <- df_primaries %>% 
	select(prim_vote_simple,
				 year,
				 pid_3,
				 therm_inparty,
				 case,
				 weight) %>%
	filter(pid_3 == "Republican" | pid_3 == "Democrat") %>% 
		glimpse() %>% 
	mutate(cold = if_else(therm_inparty < 50, 1, 0)) %>%
	group_by(prim_vote_simple,
					 pid_3,
					 year) %>% 
	summarize(pct_50_below = 100*weighted.mean(cold, weight, na.rm = TRUE),
						mean = weighted.mean(therm_inparty, na.rm = TRUE, weights = weight),
						sd = sd(therm_inparty, na.rm = TRUE),
						w.sd = radiant.data::weighted.sd(therm_inparty, wt = weight),
				  	se = diagis::weighted_se(therm_inparty, na.rm = TRUE, weight),
						n = n()) %>%
	mutate(year = as.numeric(as.character(year))) %>% 
	ungroup() %>%
	filter(prim_vote_simple != "Voted in Other Primary" & !is.na(prim_vote_simple)) %>%
	mutate(prim_vote = factor(recode_factor(prim_vote_simple, .ordered = TRUE,
														"Didn't Vote" = "Non-voter"),
														levels = c("Winner", "Non-voter", "Loser")))%>%
	filter(!(pid_3=="Republican" & (year == 2020 | year == 2004))) %>% 
	filter(!(pid_3=="Democrat" & (year == 2012))) %>% 
	glimpse() 
```

```{r mct-props, include=FALSE, eval=FALSE}
mct_prop_ns <- below_mct_ns%>% #way more measures here than are needed
  group_by(year,
  				 pid_3,
  				 primary_vote_dum)%>%
	drop_na(primary_vote_dum) %>% 
  summarise(#prop_mean_below = weighted.mean(below_mean_dum, weight, na.rm = TRUE),
            #prop_mean_sd_below = weighted.mean(below_mean_sd_dum, weight, na.rm = TRUE),
#            prop_med_below = weighted.mean(below_med_dum, weight, na.rm = TRUE), #prop_below is those below the MCT, prop_sd_below is those one SD below med
#            prop_med_below_sd = weighted.mean(below_med_sd_dum, weight, na.rm = TRUE),
            prop_50_below = weighted.mean(below_50_dum, weight, na.rm = TRUE),
            prop_80_above = weighted.mean(above_80_dum, weight, na.rm = TRUE),
            prop_75_above = weighted.mean(above_80_dum, weight, na.rm = TRUE),
#            prop_mean_sd_above = weighted.mean(above_mean_sd_dum, weight, na.rm = TRUE),
#            se_mean_below = diagis::weighted_se(below_mean_dum, weight, na.rm = TRUE),
#            se_mean_sd_below = diagis::weighted_se(below_mean_sd_dum, weight, na.rm = TRUE),
#            se_med_below = diagis::weighted_se(below_med_dum, weight, na.rm = TRUE),
#            se_med_sd_below = diagis::weighted_se(below_med_sd_dum, weight, na.rm = TRUE),
            se_50_below = diagis::weighted_se(below_50_dum, weight, na.rm = TRUE),
            se_80_above = diagis::weighted_se(above_80_dum, weight, na.rm = TRUE),
#            se_mean_sd_above = diagis::weighted_se(above_mean_sd_dum, weight, na.rm = TRUE)
  )%>%
  glimpse()

prop_below_df <- mct_prop_ns %>%
	mutate(pct_50_below = 100*prop_50_below,
				 se_pct_50_below = 100*se_50_below) %>%
	select(year,
				 pid_3,
				 pct_50_below,
				 se_pct_50_below,
				 primary_vote_dum) %>%
	mutate(pid_3 = factor(pid_3,
					 							 levels = c("Democrat",
					 							 					 "Republican",
					 							 					 "Pooled"))) %>%
	glimpse()

sd_df <- party_fts_ns_joined %>%
	select(-se_mean_in) %>% 
			mutate(pid_3  =  "Pooled",
					 pid_3 = factor(pid_3,
					 							 levels = c("Democrat",
					 							 					 "Republican",
					 							 					 "Pooled"))) %>%
	glimpse()

se_df <- full_join(prop_below_df,
									 sd_df) %>%
	select(year,
				 contains("se"),
				 pid_3) %>%
	pivot_longer(se_pct_50_below:se_sd_in,
							 names_to = "stat",
							 values_to = "se",
							 names_prefix = "se_") %>%
	glimpse()

fig_1_df <- prop_below_df %>% 
	select(year,
				 pid_3,
				 pct_50_below,
				 primary_vote_dum,
				 se_pct_50_below) %>%
	rename(se = se_pct_50_below) %>% 
	glimpse()
	pivot_longer(pct_50_below:sd_in,
							 names_to = "stat",
							 values_to = "value") %>%
	left_join(se_df) %>% 
		mutate(stat = recode(stat,
											 "pct_50_below" = "Pct. Cold",
											 "sd_in" = "Std. Dev.")) %>% 
	unite("stat", stat,pid_3, sep = " - ") %>% 
	# mutate(stat =  factor(stat,
	# 											levels = c(
	# 												"Democrat - Percent Cold"
	# 											)))
	filter(!is.na(value)) %>%  #dropping the NA values created by using Pooled only for SD
	mutate(stat = as.factor(stat),
				 stat = str_replace(stat, " - ", "\n")) %>% 
		glimpse()
```

\doublespacing

# Introduction

The descriptive patterns and deleterious effects of inter-party animus are well documented [@ahler2018a; @abramowitz2010; @iyengar2012; @iyengar2018]. What are the consequences when partisans harbor animosity towards their *own* party? This question is pressing. The number of such cold partisans is growing [@groenendyk2020]. Simultaneously, individuals are increasingly hostile towards the political system in general [@klar2018], and motivated primarily by hostility towards their out-party---not affinity for their own party [@iyengar2018]. I argue that declines in partisanship are, in part, a product of the candidate selection process. Primary elections pit partisans against their co-partisans, complicating the in-party/in-group dynamic---weakening the in-party affinity and increasing the political disdain felt by those who find themselves on the losing side of these contests.

In the wake of her 2008 primary loss to Barack Obama, supporters of Democratic standard-bearer Hillary Clinton vocally rejected the election's results, pledging to throw support behind Republican nominee John McCain and spawning the "Party Unity My Ass" movement[^1] (it is difficult to say how many PUMAs followed through with their pledge). In a Salon article published in June of 2008[^2], Rebecca Traister ties the PUMAs' anger to (among other things) the closeness of the election, perceived mistreatment by the media and DNC chair Howard Dean, and resentment at being made to feel like outsiders in their own party, saying:

[^1]: <https://www.washingtonpost.com/wp-dyn/content/article/2008/06/26/AR2008062604162.html?tid=a_inl_manual>

[^2]: <https://www.salon.com/2008/06/23/pumas/>

> "They are mad at their party and its leaders because they feel this race has opened up a door, allowing people to rag on white women...in a way that demonstrates that women have a questionable place in liberalism and progressivism. Since when is the party supposedly interested in social justice not interested in the advancement of women to the highest office?"

Clinton supporters' posture towards their party in 2016 bore little resemblance to that of the '08 race. Bernie Sanders---a former independent and self-identified socialist---leaned into the role of an insurgent, anti-establishment candidate. Sanders predicated his campaign on a conflict between the working-class Democratic base and the elites of both major parties. Following Sanders's loss his supporters, angry with the DNC and reluctant to support Clinton in November led a loosely organized movement of Democratic party discontents to found groups like *Justice Democrats* and expand membership of organizations like the *Democratic Socialists of America* and various state and local progressive caucuses to protest perceived slights by the party establishment and support further left and anti-establishment down-ballot candidates while the Clinton campaign and DNC attempted to entice their spurned co-partisans back to the fold through campaign promises and adjustments to the party platform [@seitz-wald2016].

Primary elections are complex information environments. Not only do primaries often see many more viable candidates compete against one another than do in the general, but the efficient heuristic of partisanship is of little use to voters in distinguishing between the slew of co-partisan candidates. These features of primary elections invite a useful analogy to multi-party systems. In multi-party systems, as in multi-*candidate* primary elections, the electoral spectrum is (almost by tautology) multi-dimensional, not polar as in The United States general election context. Given the primacy of negative partisanship---a dislike for the out-party---in shaping political identity [@iyengar2018], we might expect voters in multi-party contexts to behave as instrumental partisans, supporting parties and candidates as means to programmatic ends [@bankert2017]. Yet evidence for instrumental voting is scant, with multi-party voters exhibiting similar levels of expressive, identity-based partisanship as those in the United States [@adams2011; @bankert2017]. Across electoral environments, factors of identity are central to voters' decision making processes and self-perception.

Intra-party competition inherent to the primary election environment blurs the typically clear distinction between political in-groups and out-groups. Partisans seek to safeguard party cohesion [@wronski2018]. During the Presidential primary season, a primary voter's in-group is not only their fellow Democrats or Republicans, but fellow Sanders, Warren, and Buttigieg; Trump, Cruz, and Rubio voters as well. Likewise, co-partisans who support a different candidate necessarily constitute an out-group *within*, competing as they are for one nomination. If a candidate wishes to secure the plurality (or majority) of votes necessary to win the nomination without relying on chance, she must *distinguish* herself from her co-partisan opponents. This may be done by championing a particular set of policies, emphasizing ideology, professional qualifications [@kirkland2018], activating cross-cutting identities, by adopting a posture towards the political establishment [@dyck2018], etc. Regardless of the dimensions on which candidates choose to distinguish themselves, primary campaigning heightens the contradictions within a party, raising the stakes of the election.

Vote choice---or preference for a candidate more generally---is most often analyzed as the outcome of (potential) voters' preferences and evaluations of candidates' attributes. That primary voters choose their candidate in part to safeguard group cohesion in their party [@wronski2018] begs the question: what happens to the group when candidates lose? How do partisans react when the preferences of some in the party are advantaged above their own? Citizens who perceive themselves as being cut out of political decision making processes tend to be more disaffected and less participatory in democratic political activities [@soss1999; @bruch2010]. Not only do individuals assess individual political and government programs on the basis of their inclusiveness, assessments of individuals' own roles and place in political society are conditioned in part by signals they receive from political and policy actors [@campbell2012]. I argue that this is likely to hold true in the context of primary elections. Partisans whose preferences are not reflected by the party writ-large become more distrusting of political elites and display less affinity for their own party.

# Descriptive Analysis

My main measure of partisan affect is taken from the American National Election Study's (ANES) 100-point partisan feeling thermometers. Feeling thermometer questions ask respondents to rate groups on a scale from 0-100, where 0 indicates that a respondent dislikes and feels very "cold" towards the group and 100 indicates that the respondent likes and feels very "warm" towards the group. A rating of 50 degrees indicates indifference or ambivalence towards the group. I make use of the ANES Cumulative Datafile (ANES CDF) and individual releases of the ANES for years in which respondent's are asked about their primary election vote---1980, 1988, 1992, 2008, 2012, 2016, and 2020 specifically.[^3] I also draw on a range of ANES items which solicit the attitudes and behaviors of the respondent towards the government and politics. These measures are discussed in more detail in the following section. All calculations are made and figures drawn using the appropriate weighting procedures specified in the ANES Codebooks.

[^3]: The ANES CDF includes a variable indicating whether a respondent did or did not vote in a primary, but not the candidate(s) for whom they voted.

<!-- change this to be diffs between winners/losers not between hot/cold -->

Figure 1 shows the percentage of cold partisans (those who rate their own party lower than 50 degrees on the ANES feeling thermometer) in each party-year among winning and losing primary voters. Here there are several key takeaways. First, with two exceptions, losers are more likely to be cold towards their party than are winners.

Second, in the 2020 Democratic Party, losers were about six times more likely to be cold than winners---a difference that appears to have increased steadily over several decades (though data is unavailable for much of the 1990s). The percentage differences between winning and losing Republicans are less pronounced, with Republican losers only slightly more likely to be cold than winners in 2016 (2020 Republicans are excluded because only a small share participated in the presidential primary). Finally, the percentage of cold partisans in either group has trended upwards relative to the the 1980s and early 2000s; particularly among Republicans and primary losing Democrats.

```{r fig-1, fig.cap="Partisans who support a losing candidate in a presidential primary are more likely to be cold towards their in-party than supporters of primary winners. The magnitude of this difference has increased over time, particularly among Democrats."}


ggplot(fig_3_df, aes(x = year, y = pct_50_below, color = prim_vote)) +
	facet_wrap(vars(pid_3)) +
#	 geom_linerange(aes(ymin = (pct_50_below - 1.96*se), ymax = (pct_50_below + 1.96*se)), position = dodge) +
  geom_line(aes(linetype = prim_vote), size = 1, position = dodge) +
#	binomial_smooth(method = "loess", se = FALSE, aes(linetype = pid_3),) +

	geom_point(aes(shape =  prim_vote,), position = dodge, size = 3) +
#scale_color_viridis_d(option = "dividis") +
scale_color_manual(values = c("Winner" = "#481567FF",
															"Loser" = "#39568CFF")) +
 scale_linetype_manual(values = c("Winner" = "solid",
 															"Loser" = "longdash")) +
 scale_shape_manual(values = c("Winner" = 15,
  															"Loser" = 16)) +
	scale_x_continuous(breaks = c(1980, 1988, 1992, 2008, 2012, 2016, 2020)) +
	#  scale_y_continuous(breaks = c(seq(0,25, by = 5)),
	# 									  limits = c(0,20)) +
	theme(legend.position = 'bottom',
				axis.text.x = element_text(angle = 285),
				legend.key.width = unit(.1, "npc"),
				legend.key.height = unit(.05, "npc")) +
	labs(x = "Year",
			 y = "Pct. Cold",
			  color = " ",
			  linetype = " ",
			  shape = " ",
			  fill = " ",
			 title = " ",
			 caption = "Source: ANES Timeseries Study (1980, 1988, 1992, 2008, 2012, 2016, 2020)")
```

```{r fig-1a, eval = FALSE}
fig_3_df %>% 
	glimpse()
ggplot(fig_3_df, aes(x = year, y = mean, color = prim_vote)) +
	facet_wrap(vars(pid_3)) +
#	 geom_linerange(aes(ymin = (pct_50_below - 1.96*se), ymax = (pct_50_below + 1.96*se)), position = dodge) +
  geom_line(aes(linetype = prim_vote), size = 1, position = dodge) +
#	binomial_smooth(method = "loess", se = FALSE, aes(linetype = pid_3),) +

	geom_point(aes(shape =  prim_vote,), position = dodge, size = 3) +
#scale_color_viridis_d(option = "dividis") +
scale_color_manual(values = c("Winner" = "#481567FF",
															"Loser" = "#39568CFF")) +
 scale_linetype_manual(values = c("Winner" = "solid",
 															"Loser" = "longdash")) +
 scale_shape_manual(values = c("Winner" = 15,
  															"Loser" = 16)) +
	scale_x_continuous(breaks = c(1980, 1988, 1992, 2008, 2012, 2016, 2020)) +
	#  scale_y_continuous(breaks = c(seq(0,25, by = 5)),
	# 									  limits = c(0,20)) +
	theme(legend.position = 'bottom',
				axis.text.x = element_text(angle = 285),
				legend.key.width = unit(.1, "npc"),
				legend.key.height = unit(.05, "npc")) +
	labs(x = "Year",
			 y = "In-Party Therm. (Mean)",
			  color = " ",
			  linetype = " ",
			  shape = " ",
			  fill = " ",
			 title = " ",
			 caption = "Source: ANES Timeseries Study (1980, 1988, 1992, 2008, 2012, 2016, 2020)")
```

```{r google-trends, eval = FALSE}
# 
# g_df <- read_csv("data/trends-primary-election.csv") %>% 
# 	glimpse()

```

## Primary Outcomes, Belief, and Efficacy

I turn now to an examination of attitudinal and behavioral differences between supporters of primary winners and losers. Partisan warmth is a somewhat abstract concept. Survey respondents may be thinking of any number of attitudes and dispositions towards any number of party-related groups and individuals when reporting their "warmth" towards "the party". Because of this fuzzy conceptualization, the importance of studying partisan warmth is largely dependent on the degree to which partisan affect is related to more concrete sets of behaviors and opinions.

Figure 2 displays the difference in the proportions of presidential primary candidate supporters[^4] of primary winning and losing ANES respondents who indicated agreement with---or answered in the affirmative to---a variety of questions regarding their sense of political self-efficacy and behavior. Positive values indicate a higher proportion of winning partisans agree with a statement or report a certain behavior while negative values indicate losing partisans are more likely to agree with a statement or to report engaging in a behavior.

[^4]: Note that these respondents indicated *supporting* a candidate, not necessarily *voting* for the candidate. Some respondents expressed support for a primary candidate but did not indicate having *voted* for that candidate.

These data are drawn from the ANES cumulative data file (ANES-CDF) and 2020 ANES time-series study, pooling all years for which respondents presidential primary candidate preferences were solicited, that is 1980, 1988, 1992, 2008, 2012, 2016, 2020. Proportions and means were calculated in accordance with the weighting guidelines presented in the ANES-CDF variable codebook[^5]. The 6-item campaign participation index is taken from item `VCF0723` in the ANES cumulative data file. This variable is the sum of the number of campaign-related activities a respondent indicated participation in during a given election cycle---plus one---such that "$1$" indicates no campaign participation and "$6$" indicates participation in each type of activity inquired of by the interviewer. To make the difference-in-means for this item comparable with each of the difference-in-proportions calculated, the variable was rescaled such that all respondents fall in $[0,1]$ before taking the difference of the mean responses for the cold and warm groups.

[^5]: <https://electionstudies.org/anes_timeseries_cdf_codebook_var/>

Turning to the belief items illustrated in Figure 2, primary losing Democrats tend to express more pessimism about the direction of the country, the way the government is run, to distrust the government, view the country to be "on the wrong track", and to believe that the wealth gap is greater at the time of the survey than 20 years prior. No such pattern is apparent among Republican respondents. Republican supporters of losing candidates were more likely than winners to describe the country as "being on the wrong track", while more *winners* described themselves as dissatisfied with Democracy, felt that government officials don't care about their attitudes, and viewed the wealth gap as more pronounced than in the past.

That the relationship between primary outcome and political attitudes is less pronounced among Republicans than Democrats may follow from asymmetries in the Republican and Democratic electoral coalitions. Republican voters are more motivated by programmatic or ideological concerns while Democrats are more motivated by identity group interests [@grossmann2016]. Therefore, a Republican voter may be reasonably confident that their preferred candidates opponents will still hew to an acceptable ideological line, thus the stakes of the primary outcome are low. Without common ideological constraints imposed on candidates, identity-driven Democrats are more likely to fear their group-interests will be neglected by their candidate's opponents, making the stakes of a Democratic primary relatively higher than a Republican primary.

```{r ft-difs, include = FALSE}

read_rds("data/tidy-primaries-80-20.rds") %>%
	select(year,
				 case,
				 prim_vote_simple) %>% 
	glimpse()


fig_3_df %>% 
	glimpse()
#First calling the bootstrapped dfs written in plots-ft-dif-strict.R


behavior_pooled_df <- read_rds("data/tidy-behavior-prim.rds") %>%
	mutate(prop_dif_simple = -1*prop_dif_simple) %>% #recoding so that prop_dif = prop.warm - prop.cold
	mutate(which_question = fct_reorder(which_question, prop_dif_simple)) %>% 
	glimpse()

opinion_pooled_df <- 	read_rds("data/tidy-opinion-prim.rds") %>%
		mutate(prop_dif_simple = -1*prop_dif_simple) %>% #recoding so that prop_dif = prop.warm - prop.cold
		mutate(which_question = fct_reorder(which_question, prop_dif_simple)) %>% 
	glimpse()


gg_strict_opinion_pooled <- ggplot(opinion_pooled_df, aes(x = prop_dif_simple, y = fct_relabel(which_question, str_wrap, width = 20))) +
  	geom_vline(xintercept = 0.00) +
	geom_linerange(aes(xmin = prop_dif_simple - 1.96*simple_prop_se, xmax = prop_dif_simple + 1.96*simple_prop_se, color = pid_3), position = dodge) +
	#	geom_point(data=opinion_pooled_df[opinion_pooled_df$sig_dum == TRUE,],size=5, aes(position = pid_3), shape = 1, position = dodge) + #overlays a shape on sig 
	geom_point(aes(color = pid_3, shape = pid_3), size = 3, position = dodge) +
	scale_color_manual(values = c("Democrat" = "dodgerblue4",
																"Republican" = "firebrick4")) +
	coord_cartesian(xlim = c(-.4, .4)) +
	scale_x_continuous(n.breaks = 6) +	
	labs(x = "Difference",
			 y = "Question",
			 #			 title = "Difference in Proportion Whom Agree\n between Cold/Warm Partisans",
			 subtitle = "Belief Items",
			 color = "Party",
			 shape = "Party")



gg_strict_behavior_pooled <- ggplot(behavior_pooled_df, aes(x = prop_dif_simple, y = fct_relabel(which_question, str_wrap, width = 20))) +
  	geom_vline(xintercept = 0.00) +
	geom_linerange(aes(xmin = prop_dif_simple - 1.96*simple_prop_se, xmax = prop_dif_simple + 1.96*simple_prop_se, color = pid_3), position = dodge) +
	#	geom_point(data=behavior_pooled_df[behavior_pooled_df$sig_dum == TRUE,],size=5, aes(position = pid_3), shape = 1, position = dodge) + #overlays a shape on sig 
	geom_point(aes(color = pid_3, shape = pid_3), size = 3, position = dodge) +
	scale_color_manual(values = c("Democrat" = "dodgerblue4",
																"Republican" = "firebrick4")) +
	coord_cartesian(xlim = c(-.4, .4)) +
	scale_x_continuous(n.breaks = 10) +	
	theme(legend.position = c(0.8, 0.3)) +
	labs(x = "Difference",
#			 y = "Question",
			 y = " ",
			 subtitle = "Behavior Items",
			 caption = "Source: ANES (1980, 1988, 1992, 2008, 2012, 2016, 2020), \n bootstrapped 95% CI given by by errorbar.",
			 color = " ",
			 shape = " ")


#####
## Putting them into one plot
#####

#Removing redundant formatting from the plots
p1 <- gg_strict_opinion_pooled + theme(legend.position = "none",
																axis.title.x = element_blank(),
																axis.title.y = element_blank(),
																axis.text.x = element_blank())
p2 <- gg_strict_behavior_pooled + theme(
	axis.title.x = element_blank(),
	axis.title.y = element_blank())

pg <- plot_grid(p1, p2,  align = "v", nrow = 2, rel_heights = c(3/7, 4/7), label_x = "Difference") 


gg_strict_pooled_combined <- grid.arrange(arrangeGrob(pg,
																							 top = text_grob("Differences in Efficacy Between Primary Winners and Losers", vjust = 1, face = "bold"),
																			#				 left = text_grob("Question Asked", rot = 90, vjust = 1, face = "bold"),
																							 bottom = text_grob("Prop. Winners - Prop. Losers", face = "bold")))

ggsave("fig/gg-strict-pooled-combined.png", gg_strict_pooled_combined, width = 4, height = 8.5, units = "in")
```

```{r fig-display, fig.height=8.5, include=TRUE, fig.width=6, fig.align='center', fig.cap = "Differences in attitude and behavior between primary losing and winning partisans. The x-axis displays the difference between the proportion of winnig and losing partisans who answer in the affirmative to each survey item. Positive values indicate winning partisans are more likely to answer in the affirmative, negative values indicate losing partisans are more likely to respond affirmatively. Broadly, losing partisans are more cynical about the state of politics and government, but participate in politics at a similar rate to their winning co-partisans but this relationship is less pronounced among Republicans than Democrats."}
as_ggplot(gg_strict_pooled_combined)

```

Regarding the behavior and knowledge items in Figure 2, primary-losing partisans are less likely to vote in the general election, and more likely than winners to support a major out-party presidential candidate or to vote for a third-party in Presidential races. Losing Democrats were more likely than winners to report watching election related television or to talk about politics, with losers in both parties *more* likely to correctly identify the congressional majority party and no less likely than their primary winning copartisans to know which party won the House in the general election. In other words, the observed differences between winners and losers are not suggestive of political apathy, but political frustration. Primary losers are at least as talkative and knowledgeable about politics as are winners, but losers are less likely to participate directly in the electoral system and more likely to buck their party when they do.

These group differences hold important implications for politicians and party leaders who may be tempted to write off partisans spurned by the party during the primary as disengaged, low-information, or as pushovers who may put up a fuss but hold their noses and vote for the party nominee when the time comes in the general. Choosing not to respond to the complaints of unhappy partisans could cost candidates valuable votes. Particularly in an era defined by razor-thin margins in the House and Senate, small shifts in partisan turn-out can have dramatic electoral ramifications.

## Primary Outcomes and Partisan Ideology

Table 1 presents the results of four OLS linear regression models, estimating in-party and out-party feeling thermometers as a function of primary election vote choice and outcome, ideology relative to the in-party, standard demographic controls, and a series of election-year dummy variables[^6].

[^6]: The coefficients for these controls are unreported for the sake of presentation but are almost all negative and statistically significant, consistent with recent findings that intra and inter-partisan affect has declined over time [@groenendyk2020; @iyengar2018]. The full version of the table will be made available in the supporting information.

The measure of relative party ideology used in these models is constructed as the difference between respondents' ideological self-placement on the standard seven-point scale and their in-party. The scales are recoded by party such that for Democrats "1" is "Extremely Conservative" while "7" is "Extremely Liberal", for Republicans "1" is "Extremely Liberal" while "7" is "Extremely Conservative". This re-coding is done so that high values represent more extreme ideological positions for both sets of partisans. After recoding, the difference $\text{Self} - \text{In-party}$ is taken to measure the degree to which partisans perceive an ideological distance between themselves and their party. Finally, for ease of interpretation this measure is recoded so that all observations fall in $[-1, 1]$, where negative values indicate the respondent views themselves as more moderate than their party (e.g., a Republican who sees themselves as more liberal than the Republican party), while positive values indicate the respondent views themselves as more extreme than their party (e.g., a Democrat who reports being more liberal than the Democratic Party). The modal difference is 0; a plurality of respondents ascribe the same ideological identifier to themselves as to their party. Edge cases, for example, where a Republican identifies themselves as "Extremely Liberal" and their party as "Extremely Conservative" or vice-versa are exceedingly rare[^7].

[^7]: See the supporting information for the distribution of ideological placements

Columns 1 and 2 of Tab. 1 display coefficient estimates and standard errors for the model of affect towards the in-party, as measured by the partisan feeling thermometer for Democrats and Republicans respectively. Strikingly, those who supported a primary loser were almost 10 degrees colder towards their in-party than primary winners. By contrast, Democratic primary non-voters were only $4.2$ degrees colder than winners while Republican non-voters were $6.6$ degrees colder. Partisans who voted in their out-party's primary were, unsurprisingly, the coldest group: $\approx{17}$ degrees colder than winners on average. In other words, the marginal effect of supporting a losing candidate is about half that of *voting for an out-party candidate*.

\clearpage

```{r primaries-table, floating =FALSE}

primary_tab <- tab_1_df %>%
		pull(fit, name = c(pid_3))%>%
	modelsummary(output = "gt",
               gof_map = gm_3,
               coef_map = cm_3,
               stars = TRUE) %>% 
  tab_spanner(columns = 2:3, label = "In-Party") %>% 
    tab_spanner(columns = 4:5, label = "Out-Party")%>%
tab_header(title = md("**Table 1:** Estimated Individual Partisan Affect")) %>% 
  tab_footnote(md("Binary variables for election year and respondent age are included to \ control for shifts in affect exogenous to primary outcome. Those who view themselves as more extreme than their party are also warmer towards the party than those who view themselves as more moderate than the party. Relative partisan extremity is coded between [-1, 1], where negative values indicate a respondent sees themselves as much more moderate than their party, while positive values indicate the respondent views themselves as much more extreme."),
               locations = cells_title())
primary_tab
```

\clearpage

```{r margins, eval=FALSE}

# # not including ideology var because this  is probably just a proxy for partisanship
# cm_3 <- c("prim_vote_simpleLoser" = "Voted for Primary Loser",
# 					"prim_vote_simpleWinner" = "Voted for Primary Winner",
# 					"prim_vote_simpleDidn't Vote" = "Didn't Vote in Primary",
# 					"prim_vote_simpleVoted in Other Primary" = "Voted in Other Primary",
# 					"ideo_self_prt_std" = "Ideological Extremity",
# 					"ideo_self_in_dif_std" = "Relative Partisan Extremity",
# 					"ideo_dif_terc2" = "Rel. Extremity 2",
# 					"ideo_dif_terc3" = "Rel. Extremity 3",
# 					"age_group" = "Age Group",
# 					"male_dum" = "Male",
# 					"white_dum" = "White",
# 					"below_35k_dum" = "Income < $35k",
# #          "year2012" = "2012",
# #          "year2016" = "2016", 
# #          "year2020" = "2020",
#           "(Intercept)" = "Constant") 
ddf <- df_primaries %>%glimpse() 
	filter(group)
	filter(pid_3 == "In-party - Democrat") %>% 
	glimpse()

d_in <- lm(therm_dem ~ prim_vote_simple + age_group + male_dum + white_dum + year + ideo_self_in_dif_std + below_35k_dum, data = ddf,  weights = weight)

fit1 <- tab_1_df %>% 
	pull(c(fit), name = c(group_name)) %>% 
	glimpse()

d_in <- fit1["In-party - Democrat"] %>% 
	glimpse()


plot_cap(d_in, condition = c("ideo_self_in_dif_std", draw = TRUE)) +
	geom_density(ddf, aes(x = ideo_self_in_dif_std, inherit.aes = FALSE))
```

```{r, eval = FALSE, include = FALSE}
gtsave(primary_tab, "fig/primary-tab.png")
# Estimated individuals Partisan Affect

# tab_1_aug_df <- unnest(tab_1_df, aug) %>% 
# 	glimpse()

# tab_1_aug_df %>% 
# #	filter(str_detect(group_name, "In")) %>% 
# ggplot(aes(x = .fitted, y = .std.resid)) +
# 	geom_point() +
# 	geom_abline(slope = 0, intercept = 0)+
# 	facet_wrap(vars(group_name))

```

```{r, eval = FALSE}
fct_relabel(which_question_simple, str_wrap, width = 20)

coef_1_df <- tab_1_df %>%
	select(tidy,
				 group_name) %>% #just selecting out the other nested data for speed
	unnest(tidy) %>%
	filter(str_detect(term, "primary_vote") | str_detect(term, "ideo")) %>%
	mutate(term = str_remove(term, "primary_vote_simple"),
				 term = factor(recode(term, .default = term,
				 							"ideo_self_in_dif_std" = "Rel. Partisan Extremity"),
				 							levels = c("Loser",
				 												 "Didn't Vote",
				 												 "Voted in Other Primary",
				 												 "Rel. Partisan Extremity")),
				 term_wrap = fct_relabel(term, str_wrap, width = 15),
				 abs_estimate = abs(estimate)) %>%
	filter(term == "Loser" | term == "Rel. Partisan Extremity") %>%
	glimpse()

ggplot(data = coef_1_df, aes(x = term_wrap, y = abs_estimate, color = pid_3, shape = pid_3)) +
	geom_linerange(aes(ymin = abs_estimate - 1.96*std.error, ymax =  abs_estimate + 1.96*std.error), position  = dodge) +
	geom_point(position = dodge, size =  4) +
	facet_wrap(vars(therm_name)) +
		scale_color_manual(values = c("Republican" = "#481567FF",
																"Democrat" = "#39568CFF")) +
	 # scale_linetype_manual(values = c("Republican" = "solid",
	 # 															"Democrat" = "longdash")) +
	 scale_shape_manual(values = c("Republican" = 15,
	  															"Democrat" = 16)) +
	labs()

```

With respect to self-reported ideology, those who see themselves as more extreme than their party are, as argued by @groenendyk2020, predicted to be warmer towards their in-party. On average, a voter who sees themselves as much more extreme than their party; for example, an "extremely liberal" ("extremely conservative") Democrat (Republican) who sees the Democratic (Republican) Party as "extremely conservative" (extremely liberal) is about 6 degrees warmer towards their party than one who perceives the party as matching their ideology. and almost 12 degrees warmer than a partisan who sees themselves who takes a more heterodox or moderate position than the party---as in an "extremely conservative" ("extremely liberal") Democrat (Republican) who sees their party as "extremely liberal" ("extremely conservative"). However, the vast majority of respondents do not see such extreme discrepancies between the ideology of the party and their own, falling instead between $[-.5, .5]$ on the scale.

When the regression effect of relative ideology is calculated within more likely bounds, the magnitude of the effect is not as large. Most relative moderates are no more than 3 degrees colder than their party-aligned co-partisans while relative extremists are only about 3 degrees warmer. Partisans' ideological self placement is statistically tied to their attitudes towards the in-party, but this tie is insubstantial relative to party competition.

While extremity relative to the in-party is of little substantive importance to in-party attitudes, a partisan's self-reported extremity is strongly tied to their out-party attitudes (coefficients presented in columns 3 and 4 of Table 1). Democratic relative extremists are 14 degrees colder to the Republican Party than their self-identified moderate co-partisans. Republican relative extremists are more than 20 degrees colder towards the Democratic Party than moderate Republicans. The marginal effects of not voting, or voting in the out-party's primary are statistically significant predictors of out-party affect and of similar magnitude to those estimated in the in-party model.

If losing a primary caused voters to be more pessimistic towards the political system writ-large, we would expect to see negative coefficient estimates of a similar magnitude in the out-party models. This analysis provides no evidence for such a relationship, there is no significant relationship between voting for a primary loser and views towards the out-party. Whatever data generating process is responsible for the observed relationship between partisan affect and primary loss appears to be confined to the in-party, providing foundational support for the hypothesis that intra-party conflict shapes partisans' perceptions of the in-group independent of their affect towards the out-group. Supporters of primary losers do not gain any fondness for their out-party, nor do they exhibit generalized political disdain.

The cross-sectional, observational data collected from the ANES show convincingly that there are affective differences between primary winners and losers, but these analyses are limited in several crucial ways. First, using cross sectional data, we cannot distinguish between a world in which voters who dislike their party are more likely to favor candidates with dim electoral prospects. This is certainly plausible in the primary context in which the vast majority of voters are registered members of the relevant party and whose political identity is at least partially dependent on not disliking the party enough to leave it. While far from definitive, the analyses presented above give us reason to doubt this hypothesis, as even supporters of of pro-party candidates (e.g., Hillary Clinton in 2008) exhibited hostility towards their party after the primary while supporters of the famously party-hostile Donald Trump were among the most enthusiastic Republicans after the 2016 Primary.

Second, even if causal precedence could be confidently established, these data do not allow us to disentangle the impact of a primary win from a primary loss. As there is no untreated reference category who hold preferences for a primary candidate but who are unaware of the *results* of the primary, differences between winning and losing groups could follow from increased warmth among winners or coldness among losers. Observing winners and losers simultaneously obscures the data generating process resulting in differences between the groups.

```{r exp-wrangling, include = FALSE}

# Function to extract p from polr
tidy_custom.polr <- function(x, ...) {
	s <- coeftest(x)
	out <- data.frame(
		term = row.names(s),
		p.value = s[, "Pr(>|z|)"])
	out
}

# One-tailed coef test for LM

exp_df <- read_csv("data/raw/ap-experiment-08-22.csv")%>%
#	glimpse()#%>%
	select(StartDate,
#				 party_id...66,
				 party_id = party_id...18, #not sure why this is happening... something on the qtrix side of things. THis seems to be the correct pid variable.
					lean_party,
					d_loss,
					d_win,
					r_loss,
					r_win,
					control,
					therm_dem = therms_1,
					therm_rep = therms_2,
					therm_ind = therms_3,
					satisfied_democracy,
					trust_gov,
					r_gen_vote_loss:d_gen_vote_win_con,
				 comments)%>%
	.[-1,]%>%
	.[-1,]%>% #trimming off the label rows from qualtrics
	mutate(pid_3 = case_when(party_id != "Independent" & party_id != "Something Else" ~ party_id,
													 lean_party == "Neither Republican or Democrat" ~ "Independent",
													 lean_party == "Democratic" ~ "Democrat",
													 lean_party == "Republican" ~ "Republican",
													 lean_party == "Something Else" ~ "Independent",
													 TRUE ~ lean_party),
				 loss_dum = if_else(!is.na(d_loss) | !is.na(r_loss), 1, 0),
				 win_dum = if_else(!is.na(d_win) | !is.na(r_win), 1, 0),
				 control_dum = if_else(!is.na(control), 1, 0),
				 loss_dum_nc = if_else(control_dum == "1", NA_real_, loss_dum),
				 group = as.factor(case_when(loss_dum == "1" ~ "Loss",
				 									win_dum == "1" ~ "Win",
				 									control_dum == "1" ~ "Control")),
				 date = ymd_hms(StartDate),
				 therm_inparty = as.numeric(case_when(pid_3 == "Democrat" ~ therm_dem,
				 													pid_3 == "Republican" ~ therm_rep,
				 													TRUE ~ NA_character_)),
				 therm_outparty = as.numeric(case_when(pid_3 == "Democrat" ~ therm_rep,
				 																		 pid_3 == "Republican" ~ therm_dem,
				 																		 TRUE ~ NA_character_)),
				 satisfied_democracy = case_when(group == "Control" ~ NA_character_,
				                                 TRUE ~ satisfied_democracy),
				 trust_gov = case_when(group == "Control" ~ NA_character_,
				                       TRUE ~ trust_gov),
				 vote_likely = factor(case_when(pid_3 == "Democrat" & group == "Loss" ~ d_gen_vote_loss,
				 												pid_3 == "Democrat" & group == "Win" ~ d_gen_vote_win_con,
				 												pid_3 == "Republican" & group == "Loss" ~ r_gen_vote_loss,
				 												pid_3 == "Republican" & group == "Win" ~ d_gen_vote_loss,
				 												TRUE ~ NA_character_),
				 										 levels = c("Extremely unlikely",
				 										 					 "Somewhat unlikely",
				 										 					 "Neither likely nor unlikely",
				 										 					 "Somewhat likely",
				 										 					 "Extremely likely")),
				 satisfied_democracy = factor(satisfied_democracy,
				 														 levels = c("Very Dissatisfied",
				 														 					 "Somewhat Dissatisfied",
				 														 					 "Neither Satisfied nor Dissatisfied",
				 														 					 "Somewhat Satisfied",
				 														 					 "Very Satisfied")),
				 trust_gov = factor(trust_gov,
				 									 levels = c("Not at all",
				 									 					 "A little",
				 									 					 "A moderate amount",
				 									 					 "A lot",
				 									 					 "A great deal")))%>%
	filter(date > ymd("2021-08-19"))%>%
#	filter(!is.na(group))%>%
	write_rds("data/tidy-exp.rds")%>%
	write_csv("data/tidy-exp.csv")%>%
#	filter(comments == "test")%>%
	glimpse()

group_df <- exp_df%>%
	filter(pid_3 != "Independent")%>%
	group_by(group,
					 pid_3)%>%
	summarize(ft_in = mean(therm_inparty),
						se_in = sd(therm_inparty)/sqrt(length(therm_inparty)),
						n = n())%>%
	glimpse()

m1 <- exp_df%>%
	filter(pid_3 != "Independent")%>%
	glimpse()
#	filter(pid_3 == "Republican")%>%



summary(m1)

m_df <- exp_df%>%
	filter(pid_3 != "Independent")%>%
	select(vote_likely,
				 therm_inparty,
				 therm_outparty,
				 therm_ind,
				 group,
				 loss_dum_nc,
				 satisfied_democracy,
				 trust_gov)

ggplot(m_df, aes(x = therm_inparty)) +
	geom_density() + 
	facet_wrap(vars(group))

```

# Survey Experiment

To address the problem of observational equivalence inherent to time series cross sectional data, I conduct an original survey experiment using Amazon's Mechanical Turk (Mturk) platform, manipulating the outcome of counterfactual congressional primary elections. The survey was programmed using the Qualtrics survey platform and participants were recruited using Amazon's *Mechanical Turk* (Mturk) platform. The quality of data produced by Mturk-recruited samples has been the subject of substantial debate, with Mturk skeptics pointing to the lack of control afforded by the Mturk environment to the researcher and the low-stakes nature of the quick tasks workers are asked to perform [@searles2015].

Mturk samples are indeed noisier than samples obtained through more traditional methods [@johnson2020] and the population of Mturk workers is not a representative slice of the broader U.S. population [@ahler; @goodman2013]. These drawbacks make Mturk ill-suited for studies which aim to estimate the level of a parameter or quantity present in a population [@horton2011]. Fortunately, Mturk samples are much better suited to detecting *changes* in quantities. The increased noise in the Mturk sample works against statistical significance [@goodman2013] reducing the likelihood of a type-1 errors. Further, Mturk workers tend to perform *better* than other subject populations on attentiveness checks and consistently report their true preferences, provided that doing so does not jeopardize their payout [@hauser2016; @johnson2020]. As the purpose of this experiment is to interrogate shifts in partisans' affect and opinions agnostic to the absolute values of these attitudes, Mturk is an appropriate platform with which to recruit participants.

Preference falsification by participants is also not of great concern as participants were not restricted from the survey on any basis other than location of their IP address (which must be based in the United States), thus there was no financial incentive to falsify preferences. Mturk workers *are* known to falsify their IP addresses [@ahler] in order to gain access to more and higher-paying tasks, as such it is quite likely that some responses in the study were gathered from participants outside the United States who likely do not have genuine preferences about U.S. political parties. Responses of this type can artificially inflate the variation in the sample, but there is no reason to think that the sample is systematically *biased* by these responses.

## Survey Structure

After agreeing to participate in the survey, subjects are asked to divulge their partisan affiliation. Subjects who self-identified as political independents are asked towards which political party they tend to lean. Following the insight of @klar2016 that leaning independents are best understood as "secret partisans" who think and behave very similarly to typical partisan voters, leaning independents are coded as partisans of whichever party they indicate a preference towards. Those who do not indicate a preference are paid for their time and excluded from all subsequent analyses---while the attitudes and actions of these true independents are no doubt important, they fall outside the scope conditions of this investigation.

Next, participants are shown vignettes of two candidates and told that these candidates competed against one another in a 2020 congressional primary election for the participant's party. The names of these candidates are drawn from a pool of actual Democratic and Republican candidates who each participated in a congressional primary for an open seat in a district in which an out-party candidate eventually won election. In other words, none of the candidates whose names are used were members of congress during or after the 2020 election cycle. This set of names is chosen to minimize the chance of participants recognizing the candidates and noticing discrepancies between the counterfactual positions and the genuine positions of the candidate. Additionally, there is some risk that participants recruited through MTurk seek out external information for a task [@goodman2013]. The use of general-election losing non-incumbents' names reduces the accessibility of official policy statements, platforms, or campaign materials.

In addition to candidates' names, the candidate vignettes include basic personal information---party affiliation, occupation, marital status, and number of children---as well as a series of policy statements that participants are told "closely match the candidates' positions on a variety of issues." In reality, these policy positions are randomly assigned to each candidate from a set of two policy statements, one moderate and one extreme, across several issue areas. Republican participants are shown statements on climate change, abortion, policing, and taxes. Democrats are shown statements reflecting the candidates' views on the Green New Deal, marijuana legalization, policing, and taxes.

It is possible for candidates to take identical positions on any given issue and participants are informed of this in order to preempt any confusion. Importantly, this study is not concerned with *why* participants preferred one candidate over the other, simply with how a chosen candidate's fate influences individuals' partisan identity and sense of political efficacy. These candidate vignettes are intended to provide enough information to participants so as to make the candidates appear credible, and to allow the participant to form a preference for a candidate through a variety of mechanisms. Candidates' personal information is included so that participants do not view the vignettes solely as a collection of policy statements, but as a summary of a real person seeking public office.

After reviewing the vignettes, participants are asked to "write a sentence or two explaining why [they] chose [their] candidate over the other". This free-response information is solicited from participants in order to slow down the participants' (who are often trying to complete tasks as quickly as possible) thought and to increase the cognitive investment in their choice of candidate. Real world primary elections drag on for weeks and months while participants in this experiment are exposed to the candidates only for a few minutes.

After submitting their candidate preference, participants are randomly assigned to one of three groups. Those in the "Loss" treatment are told that their preferred candidate was defeated in the primary, those in the "Win" treatment are told that their candidate won the primary and went on to compete in the general election. Participants in the control group are simply thanked for selecting a candidate.

After receiving the treatment, participants were asked to rate the Democratic Party, Republican Party, and political independents on a feeling thermometer from 0-100. Participants were also asked a battery of political efficacy questions---how likely they would be to vote in the district's general election, the degree to which they trust the federal government to do what is right, and the degree to which they are satisfied with the way democracy works in the United States. After answering these questions the participants are debriefed that the candidates' personal information and policy preferences do not necessarily reflect those of the actual candidate, at which point the experiment concludes.

In total, 473 participants were surveyed. Of these only 18 identified as true independents (thus dropped from the sample), resulting in a final sample of $n = 455$. Summary statistics for these responses are presented in Table 2 and Table 3. Of note, while the distribution of in-party feeling thermometer scores is very similar to the distribution of scores drawn from the ANES time series study ($\mu = 80.9$), the distribution of out-party scores in the Mturk sample skew substantially higher than the mean out-party thermometers as reported in the ANES ($\mu = 54.5$).

The Mturk study is conducted in two parts. First, investigating the effect of winning or losing a primary election on affect towards the in-party testing the two hypotheses:

***Hyp. 1a:*** *Primary losers will be colder toward their in-party than those who do not know the primary outcome.*

***Hyp. 1b:*** *Primary winners will be warmer toward their in-party than those who do not know the primary outcome.*

Next, I investigate the effect of a primary win and loss on affect towards the *out-party* and political independents to evaluate whether the effects of primary election outcome are constrained to individuals' attitudes towards the in-party or to the political system more generally.

***Hyp. 2a:*** *Primary losers will be colder toward their out-party and independents than those who do not know the primary outcome.*

***Hyp. 2b:*** *Primary winners will be warmer toward their out-party and independents than those who do not know the primary outcome.*

The summary statistics for questions relating to these hypotheses are shown in Table 2.

```{r tab-2, fig.pos="H"}

sum_1_df <- m_df %>% 
  mutate(therm_ind = as.numeric(therm_ind)) %>% 
  rename(`Therm. In-party` = therm_inparty,
         `Therm. Out-party` = therm_outparty,
         `Therm. Independents` = therm_ind,
         `Democratic Satisfaction` = satisfied_democracy,
         `Trust in Government` = trust_gov,
         `Vote Likelihood` = vote_likely) %>%
  select(-loss_dum_nc)

sum_2_df <- sum_1_df %>% 
  select(group,
         `Therm. In-party`,
         `Therm. Out-party`,
         `Therm. Independents`)

datasummary_balance( ~group,
                    data = sum_2_df,
                    output = "gt",
                    ) %>% 
  tab_header(title = md("**Table 2:** Summary Statistics for Experimental Data A."))


```

Of note, while the distribution of in-party attitudes is similar to representative samples like the ANES, out-party attitudes are substantially warmer. This is not problematic for the study as the outcome of interest is the *response* of these levels to the randomly assigned treatment variable, not the level itself.

In the second stage I compare the differences between winning and losing partisans on three questions intended to assess participants sense of political efficacy. These are the respondents' self-reported likelihood of voting in a general election, trust in government, and satisfaction in democracy.

***Hyp. 3:*** *Primary losers will express less political efficacy than winners.*

The summary statistics for these items are displayed in Table 3.

```{r}

sum_3_df <- m_df %>% 
  mutate(therm_ind = as.numeric(therm_ind)) %>% 
  filter(group != "Control")%>%
  mutate(group = as.factor(as.character(group))) %>% 
  select(group,
         satisfied_democracy,
         trust_gov,
         vote_likely) %>% 
  rename(`Democratic Satisfaction` = satisfied_democracy,
         `Trust in Government` = trust_gov,
         `Vote Likelihood` = vote_likely)
datasummary_balance( ~group,
                    data = sum_3_df,
                    output = "gt",
                    ) %>% 
  tab_header(title = md("**Table 3:** Summary Statistics for Experimental Data B."))


```

## Partisan Affect Results

To disentangle a *positive* effect of a primary victory from a *negative* effect of a primary loss, a series of simple regression models are estimated, predicted partisan feeling thermometers as a function of two dummy variables indicating whether the participant's preferred candidate "won" or "lost" their primary bid. The control condition (no outcome information) serves as the reference category in each model. The results of these estimates are presented in Table 4.

The first model tests the effects of primary election loss and victory on in-party thermometer ratings. These results support **Hyp. 1a**, failing to support **Hyp. 1b** Primary losers are colder towards their party than those who had no information about the primary's outcome. The relatively small effect size ($\hat{\beta} \approx -3.5$) is both unsurprising. The experimental treatment is likely much weaker than a real-world primary loss. Using this analysis to estimate a precise effect size of primary outcome on partisan affect would be inappropriate. Rather, the test should be taken more generally---as evidence that losing a primary decreases positive feelings for one's own party by some amount. This test suggests that differences in in-party affect between groups of primary voters are the result of unhappiness among losers---not happiness among winners.

```{r therms-exp}
# 
# In and outparty therms

cm_1 <- c("(Intercept)" = "Constant", "groupLoss" = "Loss", "groupWin" = "Win" )
gm_1 <- tibble::tribble(
	~raw,        ~clean,          ~fmt,
	"nobs",      "N",             0,)
#	"adj.r.squared", "Adj. R2", 2,
#	"r.squared" , "R2", 2)

mods <- tibble::tribble(~name, ~fit,
  "Inparty", lm(therm_inparty ~ group, data = m_df),
		 "Outparty", lm(therm_outparty ~ group, data = m_df),
		 "Independents", lm(therm_ind ~ group, data = m_df))

inparty <- lm(therm_inparty ~ group, data = m_df)


tidy_custom.lm <- function(x, ...) {
    s <- summary(x)$coefficients
    p <- broom::tidy(x)$p.value
    out <- data.frame(
      term = row.names(s),
      p.value = p/2) # returns p.value for one-tailed test.
    return(out)
}

list("Inparty" = lm(therm_inparty ~ group, data = m_df),
		 "Outparty" = lm(therm_outparty ~ group, data = m_df),
		 "Independents" = lm(therm_ind ~ group, data = m_df))%>%
	modelsummary(output = "gt",
							 stars = TRUE,
							 coef_map = cm_1,
							 gof_map = gm_1,
							 fmt = 2,
						 statistic = c("std.error", "p.value")) %>% 
  tab_header(md("**Table 4:** Effect of Primary Outcome on Partisan Affect"))


```

If primary outcomes affected partisans' appraisals of the political system more broadly we should expect to see complementary effects across attitudes towards groups beyond participants' in-party, as observed in the cross-sectional primary election data analyses (Fig. 4). No such effects are observed, thus no support is found for **Hyp. 2a** or **Hyp. 2b**. Under these experimental conditions primary outcomes do not appear to affect attitudes towards independents or towards the out-party; partisan disdain as a result of primary loss appears to be limited to the in-party.

\clearpage

```{r political-efficacy-exp, fig.cap="test"}

# comparing Winners and Losers Political Optimism
cm_2 <- c("loss_dum_nc" = "Primary Loss"
#          "therm_inparty" = "Therm. In-party",
#          "therm_outparty" = "Therm. Out-party"
)
gm_2 <- tibble::tribble(
	~raw,        ~clean,          ~fmt,
	"nobs",      "N",             0,
	"AIC", "AIC", 2,
	"logLik" , "Log Likelihood", 2,
	"chi.sq", "Chi Sq.", 2)

list("Vote General" = MASS::polr(vote_likely ~ loss_dum_nc, data = m_df, Hess = TRUE),
			 "Trust Gov." = MASS::polr(trust_gov ~ loss_dum_nc , data = m_df, Hess = TRUE),
			 "Democ. Satisfaction" = MASS::polr(satisfied_democracy ~ loss_dum_nc, method = "logistic", data = m_df, Hess = TRUE))%>%
modelsummary(output = "gt",
             coef_map = cm_2,
						 gof_map = gm_2,
						 stars = TRUE) %>% 
						 tab_header(md("**Table 5:** Differences in Political Efficacy Between Primary Winners and Losers"))
```

## Political Efficacy Results

Next, I compare primary winners to primary losers on three political efficacy items---self-reported likelihood of voting in a general election, satisfaction with democracy, and trust in government---testing the hypothesis that those who support a losing candidate will exhibit lower political efficacy, being less likely to cast a vote, less trusting of government, and less satisfied with democracy. Each of these items were asked of respondents in the ANES-CDF, estimations of the population-level differences between cold and warm partisans on these three dimensions are included in the "Opinion" section of Figure 4.

In the experiment, those in the "Win" and "Loss" groups are asked to rate their likelihood of voting in the general election, level of trust in the United States government, and overall satisfaction with democracy on five point scales, where low (high) values indicate lower (higher) likelihood of voting, trust, and democratic satisfaction. Respondents were required to answer each question but were allowed to respond in a neutral manner.

Table 5 shows the result of three ordered logistic regression analyses where $\textit{Primary Loss} = 1$ indicates that the participant belonged to the "Loss" condition. Those for whom $\textit{Primary Loss} = 0$ belong to the win condition. Though the lack of control group responses for these questions preclude the possibility of isolating a treatment effect---the decision to treat winners as the reference category is arbitrary---assignment to either group remains random. Because $\textit{Primary Loss}$ is assigned randomly across participants any difference between winners and loser can be attributed either to $\textit{Primary Loss}$, sampling bias, or to chance, any unobserved covariates having been controlled for through randomization.

As shown in Table 5, primary losers were less likely than winners to vote and expressed less trust towards the government. Somewhat surprisingly, there was no statistically significant difference between winners' and losers' reported satisfaction with democracy. This may be reassuring to some observers who worry that primary elections undermine faith in democratic institutions [@azari2017], or the lack of a significant difference may simply be a product of an intentionally conservative (or less charitably, weak) treatment. Perhaps the loss of a paper candidate in an unidentified congressional district is not enough to shake Americans' faith in Democracy, but a more tangible defeat may be.

# Conclusion

This study challenges the commonly held assumption that in-party attitudes are stable and overwhelmingly warm. Rather, I argue that in-party attitudes are sensitive to changes in partisans' political environments, particularly those which---like primary elections---challenge partisans' existing in-group and out-group conceptualizations.

These findings should be concerning to party leadership. Losing partisans are similarly engaged with politics as their warm co-partisans but are more likely to buck the party in the voting booth and to see the political world through a more pessimistic perspective, putting party elites at risk to insurgent candidacies able to appeal to dissatisfaction with the status-quo [@dyck2018].

This study also has troubling implications for representation. The post-1968 McGovern-Fraser reforms which created the modern primary system were presented as a corrective to roiling public dissatisfaction with the democratic deficit in the pre-reform nominating process. The modern primary system has proven insufficient to eliminate dissatisfaction with the nominating process as evidenced by recent high-profile fights in both parties between incumbent and insurgent primary challengers. The analyses presented in this study further suggest that primaries may not simply be a stage on which existing intra-party grievances are aired but a mechanism through which grievances are exacerbated or created.

To those concerned about *inter*-party affective polarization, a decline in esteem for one's in-party may not sound like much of a problem. Perhaps, if inter-party polarized partisans grow less fond of their own parties they may begin to see their out-party's point of view or at least to see a narrower gulf between the two. Such a prediction would be misguided. Though they may cross party lines occasionally, there is little evidence that those who dislike their party hold any greater affinity for the opposition than their peers do. Primary loss depresses intra-party affinity but out-party attitudes remain stable and overwhelmingly negative.

The relationship between primary outcomes and partisan affect and political self-efficacy is consistently different between parties. Democratic losers are reliably colder and less efficacious than winners while Republican winners are sometimes *more* pessimistic than losers. One explanation for this divergence is that Republicans' political motivations are rooted in programmatic and ideological preferences to a greater degree than Democrats', whose political preferences are rooted in group interest [@grossmann2016]. Republicans may see fewer differences within a primary slate of candidates generally motivated by common ideological goals than Democrats who fear their group preferences may go wholly unrepresented if their preferred candidate loses.

Finally, more work should be done to understand how persistent over time the effects of primary outcomes are. Do partisans spurned by their party move quickly past their frustrations or does the sting of defeat stick with the voter, compounding with other political disappointments?

\clearpage

# References

::: {#refs}
:::

```{=html}
<!-- \clearpage 

# (APPENDIX) Appendix {-}  



As identified by @iyengar2012 and @iyengar2018, the decline in warmth towards the out-party is notable. From 2004--2020 mean out-party attitudes dropped from an already chilly $\approx{40}$ to $\approx 20$. Out-party attitudes are only one side of partisan affect and are not the principal focus of this study. Attitudes towards the in-party are certainly much more favorable than those towards the out-party but are still subject to variation. Most obviously, Republicans' mean in-party thermometer dropped by $\approx{10}$ points (one tenth of the feeling thermometer scale) between 2004 and 2016, before rebounding to Bush-era highs during the 2020 election cycle. Democrats' mean thermometer rating also dropped over this time period, though by a much smaller amount than that of their Republican counterparts.

```

```{r cdf-sd-app, eval = FALSE, fig.cap="Changes in the standard deviation of in-party feeling thermometers."}



below_mct_ns <- cdf_trimmed%>% # MCT = Measure of Central Tendency
#below_mct_ns <- cdf_extended%>% # with 2020
  select(year,
         weight,
         pid_3,
         therm_inparty)%>%
  filter(pid_3 != "Independent" & year != 2002)%>%
  mutate(above_80_dum = if_else(therm_inparty > 80, 1, 0),
         above_75_dum = if_else(therm_inparty > 75, 1, 0),
         above_mean_sd_dum = if_else(therm_inparty > weighted.mean(therm_inparty, weight, na.rm = TRUE) + radiant.data::weighted.sd(therm_inparty, weight, na.rm = TRUE), 1, 0),
         below_50_dum = if_else(therm_inparty < 50, 1, 0),
#         below_mean_dum = if_else(therm_inparty < weighted.mean(therm_inparty, weight, na.rm = TRUE), 1, 0),
#         below_mean_sd_dum = if_else(therm_inparty < weighted.mean(therm_inparty, weight, na.rm = TRUE) - radiant.data::weighted.sd(therm_inparty, weight, na.rm = TRUE), 1, 0),
#         below_med_dum = if_else(therm_inparty < spatstat::weighted.median(therm_inparty, weight, na.rm = TRUE), 1, 0),
#         below_med_sd_dum = if_else(therm_inparty < spatstat::weighted.median(therm_inparty, weight, na.rm = TRUE) - radiant.data::weighted.sd(therm_inparty, weight, na.rm = TRUE), 1, 0)
)%>%
  glimpse()

mct_prop_ns <- below_mct_ns%>% #way more measures here than are needed
  group_by(year, pid_3)%>%
  summarise(#prop_mean_below = weighted.mean(below_mean_dum, weight, na.rm = TRUE),
            #prop_mean_sd_below = weighted.mean(below_mean_sd_dum, weight, na.rm = TRUE),
#            prop_med_below = weighted.mean(below_med_dum, weight, na.rm = TRUE), #prop_below is those below the MCT, prop_sd_below is those one SD below med
#            prop_med_below_sd = weighted.mean(below_med_sd_dum, weight, na.rm = TRUE),
            prop_50_below = weighted.mean(below_50_dum, weight, na.rm = TRUE),
            prop_80_above = weighted.mean(above_80_dum, weight, na.rm = TRUE),
            prop_75_above = weighted.mean(above_80_dum, weight, na.rm = TRUE),
#            prop_mean_sd_above = weighted.mean(above_mean_sd_dum, weight, na.rm = TRUE),
#            se_mean_below = diagis::weighted_se(below_mean_dum, weight, na.rm = TRUE),
#            se_mean_sd_below = diagis::weighted_se(below_mean_sd_dum, weight, na.rm = TRUE),
#            se_med_below = diagis::weighted_se(below_med_dum, weight, na.rm = TRUE),
#            se_med_sd_below = diagis::weighted_se(below_med_sd_dum, weight, na.rm = TRUE),
            se_50_below = diagis::weighted_se(below_50_dum, weight, na.rm = TRUE),
            se_80_above = diagis::weighted_se(above_80_dum, weight, na.rm = TRUE),
#            se_mean_sd_above = diagis::weighted_se(above_mean_sd_dum, weight, na.rm = TRUE)
  )%>%
  glimpse()

n_df_ns <- cdf_trimmed%>% # Making a DF of the party-year SD
  filter(pid_3 != "Independent" & year != 2002)%>%
  select(year,
         weight,
         pid_3,
         therm_inparty,
         therm_outparty)%>%
  group_by(year, pid_3)%>%
  summarise(n = n(),
            mean_in = weighted.mean(therm_inparty, weight, na.rm = TRUE),
            mean_out = weighted.mean(therm_outparty, weight, na.rm = TRUE),
            sd_in = radiant.data::weighted.sd(therm_inparty, weight, na.rm = TRUE),
            sd_out = radiant.data::weighted.sd(therm_outparty, weight, na.rm = TRUE))%>%
  glimpse()


df_for_sampling <- cdf_trimmed%>% # Making a DF of the party-year SD
  filter(pid_3 != "Independent" & year != 2002)%>%
  select(year,
         weight,
         pid_3,
         therm_inparty,
         therm_outparty,
         pid_7
  )%>%
glimpse()


#bootstrapping the SE of the SD
boot_sd_in <- data.frame(boot = 1:500)%>%
  group_by(boot)%>%
  do(sample_n(df_for_sampling, 
              nrow(df_for_sampling),
              replace = TRUE))%>% #creating 100 new datasets of equal size to the original
  group_by(boot,
           year,
           pid_3)%>%
  summarise(mean_in = weighted.mean(therm_inparty, weight, na.rm = TRUE),
            mean_out = weighted.mean(therm_outparty, weight, na.rm = TRUE),
            sd_in = radiant.data::weighted.sd(therm_inparty, weight, na.rm = TRUE),
            sd_out = radiant.data::weighted.sd(therm_outparty, weight, na.rm = TRUE))%>%
  group_by(year,
           pid_3)%>%
  summarise(se_mean_in = sd(mean_in),
            se_mean_out = sd(mean_out),
            se_sd_in = sd(sd_in),
            se_sd_out = sd(sd_out))%>%
  pivot_longer(se_mean_in:se_sd_out, names_to = "group", values_to = "result")%>%
  unite("group", pid_3:group)%>%
  mutate(stat = as.factor(if_else(str_detect(group, "mean"), "se_mean", "se_sd")))%>%
  mutate(group = as.factor(recode(group,
                                  "Democrat_se_mean_in" = "Democrat - In Party",
                                  "Democrat_se_mean_out" = "Democrat - Out Party",
                                  "Democrat_se_sd_in" = "Democrat - In Party",
                                  "Democrat_se_sd_out" = "Democrat - Out Party",
                                  "Republican_se_mean_in" = "Republican - In Party",
                                  "Republican_se_mean_out" = "Republican - Out Party",
                                  "Republican_se_sd_in" = "Republican - In Party",
                                  "Republican_se_sd_out" = "Republican - Out Party")))%>%
  glimpse()

prop_below_df <- mct_prop_ns %>%
	mutate(pct_50_below = 100*prop_50_below,
				 se_50_below_pct = 100*se_50_below) %>%
	select(year,
				 pid_3,
				 pct_50_below,
				 se_50_below_pct) %>% 
	glimpse()

sd_df <- party_fts_ns_joined %>%
	filter(!str_detect(group, "Out"))%>%
	mutate(pid_3 = as.factor(str_extract(group, "(^\\w*)"))) %>%
	select(-mean,
				 -se_mean,
				 -group) %>% 
	glimpse()

fig_1_df <- left_join(prop_below_df,
											sd_df) %>%
	glimpse()

gg_fig_1 <- fig_1_df%>%
  ggplot(aes(x = year, y = stat, color = group)) +
#  geom_smooth(aes(linetype = group), span = .3, se=F) + 
  geom_line(aes(linetype = group), size = 1, position = dodge) +
#  geom_errorbar(aes(ymin = sd - 1.96*se_sd, ymax = sd + 1.96*se_sd), width = 2, position = dodge) +
  geom_linerange(aes(ymin = sd - 1.96*se_sd, ymax = sd + 1.96*se_sd, color = group), position = dodge) +
  geom_point(aes(shape = group), position = dodge, size = 3) +
  scale_linetype_manual(values = c("Democrat - In Party" = "longdash",
                                   "Republican - In Party" = "solid")) +
  scale_shape_manual(values = c("Democrat - In Party" = 17,
                                "Republican - In Party" = 16)) +
  scale_color_manual(values = c("Democrat - In Party" = "dodgerblue4",
                                "Republican - In Party" = "firebrick4")) +
  #scale_x_continuous(limits = c(1978,2020), breaks = c(0:5)) +
  scale_x_continuous(breaks = c(seq(1978, 2020, by = 2)),# guide = guide_axis(n.dodge = 2)
  									 ) +
#  scale_y_continuous(limits = c(14,25)) +
  labs(y = "SD",
       x = "Year",
       title = "Standard Deviation of In-Party Feeling Thermometers",
       linetype = " ",
       color = " ",
       shape = " ",
       caption = "Bootstrapped 95% CI Given By Errorbar") +
  theme(legend.position = c(0.2, 0.8),
        legend.key.width = unit(.1, "npc"),
        legend.key.height = unit(.075, "npc"),
  			axis.text.x = element_text(angle = 285)) +
  guides(size = "none")
gg_sd_ft_ns

gg_below_50_ns <- ggplot(mct_prop_ns, aes(x = year, y = prop_50_below)) +
  geom_line(aes(linetype = pid_3, color = pid_3), position = dodge, size = 1) + 
  #  geom_smooth(aes(linetype = pid_3_sort, color = pid_3_sort), span = .3, se = FALSE) +
  geom_linerange(aes(color = pid_3, ymin = prop_50_below - 2*se_50_below, ymax = prop_50_below + 2*se_50_below), position = dodge) +
  geom_point(aes(shape = pid_3, color = pid_3), position = dodge, size = 4) +
  scale_color_manual(values = c("Democrat" = "dodgerblue4",
                                "Republican" = "firebrick4")) +
  scale_linetype_manual(values = c("Democrat" = "longdash",
                                   "Republican" = "solid")) +
	  scale_x_continuous(breaks = c(seq(1978, 2020, by = 2)))+
  theme(legend.position = c(0.1, 0.7)) +
  guides(size = "none") +
	  theme(legend.position = c(0.2, 0.8),
        legend.key.width = unit(.1, "npc"),
        legend.key.height = unit(.075, "npc"),
	  		axis.text.x = element_text(angle = 285)) +
  labs(x = "Year", 
       y = "Proportion",
       color = "Party ID",
       linetype = "Party ID",
       shape = "Party ID",
       title = "Proportion of Partisans Below 50 In-Party FT",
       caption = "95% CI Given With Errorbar") #+
#  facet_wrap(vars(pid_str))
gg_below_50_ns


```

```{r cdf-means-app, eval = FALSE, fig.cap="Time-series shifts in partisan affect.", fig.showtext=TRUE}
gg_mean_ft_ns <- ggplot(party_fts_ns_joined, aes(x = year, y = mean)) +
#  geom_smooth(aes(linetype = group, color = group), span = .3, se=F) +
  geom_line(aes(linetype = group, color = group), position = dodge) +
#  geom_linerange(aes(ymin = mean-sd, ymax = mean+sd, color = group), position = dodge) +
  geom_point(aes(shape = group, color = group), size = 3, position = dodge) +
  scale_linetype_manual(values = c("Democrat - In Party" = "longdash",
                                   "Democrat - Out Party" = "dotted",
                                   "Republican - In Party" = "solid",
                                   "Republican - Out Party" = "twodash")) +
  scale_shape_manual(values = c("Democrat - In Party" = 17,
                                   "Democrat - Out Party" = 2,
                                   "Republican - In Party" = 16,
                                   "Republican - Out Party" = 1)) +
  scale_color_manual(values = c("Democrat - In Party" = "dodgerblue4",
                                   "Democrat - Out Party" = "dodgerblue1",
                                   "Republican - In Party" = "firebrick4",
                                   "Republican - Out Party" = "firebrick1")) +
  #scale_x_continuous(limits = c(1978,2020), breaks = c(0:5)) +
	  scale_x_continuous(breaks = c(seq(1978, 2020, by = 2)))+
  scale_y_continuous(breaks = seq(0, 80, by = 10), limits = c(0,80)) +
  labs(y = "Mean",
       x = "Year",
       title = "Mean Thermometer Ratings of Partisans",
       linetype = " ",
       color = " ",
       shape = " ") +
  theme(legend.position = c(0.2, 0.2),
  			axis.text.x = element_text(angle = 285)) +
  guides(size = FALSE
#         shape = guide_legend(override.aes = list(size = 1.5))
         )
 showtext_auto()
gg_mean_ft_ns
#pdf("extrafont-1-unembedded.pdf", 7, 4)
ggsave("gg-cdf-means.pdf", gg_mean_ft_ns, width = 6, height = 4, units = "in")
```

My analysis of intra-party attitudes begins by taking a broad view of trends in partisan's attitudes for their own party and its opposition. Figure 1 uses data from the American National Election Study (ANES) to show the mean in-party and out-party feeling thermometers from 1978 to 2020, the full time range over which the partisan feeling thermometer question is included on the ANES^[Pre-1978 iterations of the ANES study include some feeling thermometer questions, but ask respondents to rate "Democrats and Republicans", rather than the "Democratic and Republican Parties". In years where both questions are asked there are considerable differences in mean thermometer ratings---the questions are not equivalent to one another.]. Calculations of all mean values and their variance are weighted in accordance with procedures outlined in the ANES codebooks.


Further, individuals conceptualize their in-group in contrast to the out-group [@tajfel1974; @leonardelli2015; @mead2012]---a conception of the in-group is predicated on drawing clear distinctions with the out-group. In multi-party and coalition-based systems, discerning a clearly defined political in-group and out-group is difficult. As such, voters' sense of belonging to a party is weaker relative to the U.S. context [@bankert2017]. The within-party electoral environment of a primary is clearly not a perfect analogue to multi-party electoral environments but is similar in that primary voters are often exposed to messaging from a range of broadly similar but competing campaigns, with no one campaign representing a clear *de facto* in-group.

Party elites may not be *government* policymakers or bureaucrats, but they are certainly *political* actors; their sphere of policy influence is simply constrained to the internal workings of one party---not the government writ-large. It is unlikely that the blurry distinction between "government" and "political" matters all that much to the rationally ignorant median voter as they assimilate political information and update their evaluations of elites and themselves. Moreover, government employees and party apparatchiks each wield considerable power shaping possible policy outcomes. Insofar as disaffection stems from being "cut out" of the policy process it is not clear that the legal distinction between government and party *should* be salient to observers, political sophisticates or not. Further, primary elections are programs designed and implemented by a vast bureaucracy of national and state parties, private information systems providers, federal government regulators, and local supervisors of elections; structurally similar to many federated programs, even if the primary bureaucracy only becomes salient to the public every two or four years at best. 

```{r ridge-plot-app, eval = FALSE}

# Might ditch this for the plot of prop cold
ridge_df_all <- cdf_trimmed%>%
#ridge_df_all <- cdf_extended%>%
  filter(year != 2002)%>%
	filter(pid_7 != "Independent - Independent") %>% 
  mutate(year_fct = fct_rev(as.factor(year))) %>% 
	mutate(log_in = log(therm_inparty),
				 era = factor(if_else(year < 2000, "Before 2000", "After 2000"),
				 						 levels = c("Before 2000", "After 2000"))) %>%
	glimpse()

ridge_df_all %>% 
	group_by(year_fct) %>% 
	summarize(n = n())

ggplot(data = ridge_df_all, aes(x = fct_rev(year_fct),
																y = therm_inparty,
																fill = pid_3, 
																color = pid_3, 
																weight = weight)) +
	geom_violin(aes(weight = weight,
									adjust = 1/5)) +
	theme(legend.position = "top",
					axis.text.x = element_text(angle = 285)) +
	  scale_linetype_manual(values = c("Democrat" = "longdash",
                                   "Republican" = "solid")) +
  scale_shape_manual(values = c("Democrat" = 17,
                                   "Republican" = 16)) +
	  scale_fill_manual(values = c("Democrat" = "dodgerblue4",
                                   "Republican" = "firebrick4")) +
  scale_color_manual(values = c("Democrat" = "dodgerblue4",
                                   "Republican" = "firebrick4")) +
	labs(x = "year",
			 y = "In-party Feeling Thermometer",
			 title = "Distribution of In-Party Feeling Over Time")
#	scale_x_continuous(breaks = c(seq(1978, 2020, by = 2)))


ggplot(data = ridge_df_all, aes(x = fct_rev(year_fct),y = therm_inparty, color = pid_3)) +
	geom_boxplot(aes())



ggplot(data = ridge_df_all, aes(x = era,
																y = therm_inparty,,
																fill = pid_3, 
																color = pid_3, 
																weight = weight)) +
	geom_violin(aes(weight = weight,
									adjust = 1/5)) +
	theme(legend.position = "top",
					axis.text.x = element_text(angle = 285)) +
	  scale_linetype_manual(values = c("Democrat" = "longdash",
                                   "Republican" = "solid")) +
  scale_shape_manual(values = c("Democrat" = 17,
                                   "Republican" = 16)) +
	  scale_fill_manual(values = c("Democrat" = "dodgerblue4",
                                   "Republican" = "firebrick4")) +
  scale_color_manual(values = c("Democrat" = "dodgerblue4",
                                   "Republican" = "firebrick4")) +
	labs(x = "year",
			 y = "In-party Feeling Thermometer",
			 title = "Distribution of In-Party Feeling Over Time")


```


```{r primaries-plots-app, eval = FALSE, echo=FALSE,warning=FALSE, fig.cap="Distribution of partisan affect between primary candidate supporters 2008--2020"}


gg_primary_in <- ggplot(df_primaries, aes(x = therm_inparty, color = primary_vote_simple, linetype = primary_vote_simple)) +
	geom_density(size = .9,
							 alpha = 1,
							 show.legend = FALSE) +
	facet_grid(rows = c(vars(year)), 
						 cols = c(vars(pid_3))) +
#	geom_vline(aes(color = primary_vote_simple, xintercept = mean(therm_inparty, na.rm = TRUE)))
	geom_vline(data = df_in_means, 
						 aes(xintercept=mean_ft, 
								 color = primary_vote_simple,
								 linetype = primary_vote_simple),
						 size = 1,
						 alpha = .5) +
	theme(#legend = element_re(angle = 90),
				legend.key.height = unit(.1, "npc"),
				legend.key.width = unit(.1, "npc"),
		#		legend.position = c(.7, .2),
				legend.text = element_text(size = rel(1.2)),
				legend.title = element_blank(),
				plot.title = element_text(hjust = 0)) +
	
	scale_color_manual(values = c("Winner" = "#FFC20A", #colorblind safe palette
										 "Loser" = "#0C7BDC"))+
	scale_linetype_manual(values = c(
																	 "Winner" = "longdash",
																	 "Loser" = "dotdash")) +
	labs(x = "Thermometer",
			 y = "Density",
			 title = "Distribution of In-party Warmth",
			 color = "Primary Vote",
			 linetype = "Primary Vote",
			 caption = "Group mean given by vertical lines.")

gg_primary_in
#putting them together

# p1 <- gg_primary_in + theme(legend.position = "none",
# 														axis.title.x = element_blank(),
# 													  axis.title.y = element_blank(),
# 														axis.text.y = element_blank(),
# 												#		title = element_text(size = 8)
# 														)
# 
# 
# p2 <- gg_primary_out + theme(
# 	axis.title.x = element_blank(),
# 	axis.title.y = element_blank(),
# 	strip.text.y = element_blank()
# #	title = element_text(size = 8)
# )
# 
# 
# 
# grid.arrange(arrangeGrob(p2, p1,
# 																				 ncol = 2,
# 																				 top = text_grob("Distribution of Partisan Warmth\n by Primary Vote", vjust = 1, face = "bold"),
# 																				 left = text_grob("Density", rot = 90, vjust = 1, face = "bold"),
# 																			   bottom = text_grob("Feeling Thermometer", face = "bold")))


```

```{r, eval = FALSE}
ggplot(ridge_df_all, aes(x = therm_inparty, y = year_fct, fill = stat(x), color = "white")) +
  geom_density_ridges_gradient(scale = 3, rel_min_height = 0.02, gradient_lwd = 1) +
  coord_cartesian(clip = "off") +
  scale_x_continuous(limits = c(0,100), breaks = seq(0, 100, by = 10)) +
  scale_fill_gradient(
    low = "blue1",
    high = "red4"
  ) +
  scale_discrete_manual(aesthetics = "color",
                        values = c("white")) +
  geom_vline(xintercept = 50, color = "white") +
  guides(color = "none",
         fill = "none") +
  labs(title = "Changing distribution of in-party feeling thermometers",
       subtitle = "Republicans and Democrats",
       y = "Year",
       x = "Feeling Thermometer",
       caption = " ") +
	#coord_flip()+
  theme(#panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_blank())
```

```{r image-ref-for-in-text, eval = FALSE, echo = FALSE, message=FALSE, fig.align='center', fig.cap='Some cool caption', out.width='0.75\\linewidth', fig.pos='H'}
knitr::include_graphics("gg-cdf-means.pdf")
```


```{r ridge-plot-working, eval = FALSE}

# Might ditch this for the plot of prop cold
ridge_df_all <- cdf_trimmed%>%
#ridge_df_all <- cdf_extended%>%
  filter(year != 2002)%>%
  mutate(year_fct = fct_rev(as.factor(year)))

ggplot(ridge_df_all, aes(x = therm_inparty, y = year_fct, fill = stat(x), color = "white")) +
  geom_density_ridges_gradient(scale = 3, rel_min_height = 0.02, gradient_lwd = 1) +
  coord_cartesian(clip = "off") +
  scale_x_continuous(limits = c(0,100), breaks = seq(0, 100, by = 10)) +
  scale_fill_gradient(
    low = "blue1",
    high = "red4"
  ) +
  scale_discrete_manual(aesthetics = "color",
                        values = c("white")) +
  geom_vline(xintercept = 50, color = "white") +
  guides(color = "none",
         fill = "none") +
  labs(title = "Changing distribution of in-party feeling thermometers",
       subtitle = "All Respondents",
       y = "Year",
       x = "Feeling Thermometer",
       caption = " ") +
  theme(#panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_blank())
```


# Panel Study Analysis

To overcome this problem of observational equivalence, I first draw on a panel study conducted as part of the 2008 National Annenberg Election Survey (NAES) by the Annenberg Public Policy Center. Respondents were surveyed across five waves from October 7, 2007 (pre-primary) to January 31, 2009 (post-innauguration). These panel data allow us to overcome the problem of observational equivalence inherent to cross-sectional data by estimating the treatment effect of supporting a losing candidate before and after their loss is apparent. 

As the 2008 NAES does not solicit partisan feeling thermometers from respondents strong partisanship is used as an imperfect proxy for a partisan feeling thermometer on the grounds that those who identify as strong partisans unsurprisingly tend to report higher in-party feeling thermometers than their less strong and leaning co-partisans^[A table and figure which use ANES data to support this assumption are made available in this study's supporting information.].


```{r, include=FALSE}

gg_three_wave_df <- read_rds("data/gg-three-wave-str.rds")%>%
  select(pid_3_1,
         first_choice_dum_1,
         wave_presump,
         wave,
         prop_strong,
         se_strong)%>%
  mutate(wave_norml = recode(wave_presump,
                               "Before Presumptive" = "Wave 2 - Wave 1",
                               "After Presumptive" = "Wave 3 - Wave 2"),
         choice_dum = fct_rev(first_choice_dum_1))


```

```{r gg-three-wave, fig.cap="Three-wave test of primary outcome and strong partisanship"}
  
gg_three_wave_df%>%
ggplot(aes(x = choice_dum, y = prop_strong, color = pid_3_1)) +
	geom_linerange(aes(ymin = prop_strong - 1.95*se_strong, ymax = prop_strong + 1.95*se_strong, color = pid_3_1)) +
  geom_line(aes(x = as.numeric(choice_dum), color = pid_3_1, linetype = pid_3_1)) +
	geom_point(aes(shape = pid_3_1), size = 2) +
	geom_hline(yintercept = 0) +
	scale_color_manual(values = c("Democrat" = "dodgerblue3",
																"Republican" = "firebrick3")) +
	facet_wrap(vars(wave_norml)) +
	theme(legend.position = c(0.2, 0.2)) +
	coord_cartesian(ylim = c(-.25, .25)) +
	labs(title = "Change in Proportion of Strong Partisans between waves",
			 x = "Primary Vote Choice",
			 y = "Difference Between Waves",
			 color = "Party ID at Wave 1",
			 linetype = "Party ID at Wave 1",
			 shape = "Party ID at Wave 1",
			 caption = "Bootstrapped 95% CIs") +
	scale_y_continuous(n.breaks = 10)

```

Figure 6 shows the results of a three-wave-test of primary election outcome on strength of partisanship. Each point of the figure represents the change in the proportion of strong partisans present in each group between waves. The first panel (Wave 2 -- Wave 1) shows the within-group change in strong partisanship between the two waves preceding the selection of a presumptive nominee in the relevant party's presidential primary. The second panel (Wave 3 - Wave 2) shows shows the change in strong partisanship within groups between the second (pre-treatment) wave and the third (post-treatment wave). The treatment in this case is the revelation of one candidate as the primary winner. Under this implementation of the three-wave-test, the average treatment effect (ATE) for each party is calculated as the difference-in-difference in the proportion of strong partisans between winners and losers before and after the results of the primary election become clear:


$$
[\Delta(W)_{32} - \Delta(L)_{32}]-[\Delta(W)_{21} - \Delta(L)_{21}] 
$$

Where $\Delta(W)_{ts}$ is the change in proportion of strong partisans supporting a winning candidate between times $t, s | s<t$ and $$\Delta(L)_{ts}$$ is the proportion of strong partisans supporting a losing between times $t, s$. Additionally, $(T,S) < 3$ occurs pre-treatment and $T=3$ occurs post-treatment. A larger difference (a steeper slope) between winners and losers after the treatment is primed suggests an effect of primary outcome on strength of partisanship.

Tests which compare only the pre and post treatment absolute value of a quantity are vulnerable to confounding pre-treatment effects [@lenz2013]. Analysis of cross-sectional data is unable to establish causal precedence---a situation in which cold partisans gravitate towards ill-equipped primary candidates is observationally equivalent to one in which a primary loss causes individuals to dislike their party. By comparing the change in "effect" of a primary outcome before and after the outcome is known, unobserved pre-treatment differences between supporters of winning and losing candidates are cancelled out. It is quite likely that voters' degree of partisanship plays some role in informing their preferences for a primary candidate. The key assumption on which the three-wave test is that by comparing the baseline pre-treatment difference in the rates-of-change between groups to the post-treatment difference in rates-of-change between groups, the researcher isolates the true effect of the treatment, even if selection into treatment groups is non-random.

Referring to Figure 4, the flat slope of Democratic and Republican lines in the left-hand panel indicate that the proportion of strong partisans in each group---eventual winners and eventual losers---changed by similar amounts between  pre-treatment waves 1 and 2. Whichever unobserved variables may have affected the tendency of primary voters to identify as strong partisans appear to affect winners and losers of both parties similarly. The right-hand panel shows the difference between wave 2 (pre-treatment) and wave 3 (post-treatment). While both winning and losing Democrats became more likely to self-identify as strong-partisans, the difference between winners and losers became much greater. The proportion of strong partisans among losing Democrats (almost entirely Hillary Clinton supporters) increased by about $.045$ after Obama's ascension as presumptive nominee while the proportion of Obama supporters identifying as strong Democrats increased by about $.11$, more than double that of the increase among Clinton supporters.

The greater increase in strong partisanship among winning Democrats suggests that Obama supporters' affinity for their own party increased as a result of his primary victory. There is no such effect observed among Republicans, who become less likely to identify as strong partisans regardless of which candidate they supported in the primary. It is difficult to assess why this might be, given that data from only one election cycle is available. Perhaps Republicans' grim electoral prospects implied by the underwater approval of the Bush Administration, unpopular wars in Iraq and Afghanistan, and economic anxiety suppressed any partisan enthusiasm felt by supporters of John McCain's primary bid. It is also possible that as the Republican Party electoral coalition is more ideological than the Democrats' coalition rooted in group interest [@grossmann2016] primary outcomes affect Republicans' and Democrats' partisanship in different ways, though there is little else in my analyses that support such a conclusion.

```{r cdf-sd, eval=FALSE, fig.cap="Changes in the standard deviation of in-party feeling thermometers."}

ggplot(fig_1_df, aes(x = year, y = pct_50_below, color = pid_3)) +
	facet_wrap(vars(primary_vote_dum)) +
	 geom_linerange(aes(ymin = (pct_50_below - 1.96*se), ymax = (pct_50_below + 1.96*se)), position = dodge) +
  geom_line(aes(linetype = pid_3), size = 1, position = dodge) +
	geom_point(aes(shape =  pid_3,), position = dodge, size = 3) +
#scale_color_viridis_d(option = "dividis") +
scale_color_manual(values = c("Republican" = "#481567FF",
															"Democrat" = "#39568CFF")) +
 scale_linetype_manual(values = c("Republican" = "solid",
 															"Democrat" = "longdash")) +
 scale_shape_manual(values = c("Republican" = 15,
  															"Democrat" = 16)) +
	scale_x_continuous(breaks = c(seq(1978, 2020, by = 2))) +
	# scale_y_continuous(breaks = c(seq(0,25, by = 5)),
										 # limits = c(0,25)) +
	theme(legend.position = 'bottom',
				axis.text.x = element_text(angle = 285),
				legend.key.width = unit(.1, "npc"),
				legend.key.height = unit(.05, "npc")) +
	labs(x = "Year",
			 y = "Percentage",
			  color = " ",
			  linetype = " ",
			  shape = " ",
			  fill = " ",
			 title = "In-Party Heterogeneity Over Time",
			 caption = "Bootstrapped 95% confidence intervals given by error bars.")

```

# Old Intro

It is well-documented that democratic accountability suffers under conditions of inter-party animus. What are the consequences when partisans harbor animosity towards their *own* party? @groenendyk2020 identify such cold partisans,  arguing that intra-party polarization is occurring along ideological lines as self-identified moderate Democrats and Republicans become less enthusiastic about their parties while their co-partisans on the left and right respectively grow more favorable towards the party. It is difficult to square the ideological polarization proposed by @groenendyk2020 with the qualitative features of the visible power struggle within the parties. I propose a supplementary explanation: that intra-party contests, particularly primary elections, complicate the in-party/in-group dynamic. Ultimately, weakening the in-party affinity and increasing the political disdain felt by those who find themselves on the losing side of these contests.

Journalism and scholarship have been rife with accounts of the animosity exhibited by the activists and elected officials on the Democratic Party's left towards the more centrist mainline of the party [@azari2017; @thompson2020]. @masket2020 details lingering animosity between supporters and staffers for the 2016 campaigns of Bernie Sanders and Hillary Clinton (as well as a disdain for individuals associated with the Sanders campaign expressed by former Martin O'Malley organizers). In the Republican camp distinctions between "insurgents" and the "mainline" are not as clear, given that the insurgent candidate, Donald Trump, claimed victory in 2016. However, supporters of the 2016 Sanders and Trump candidacies were motivated largely by a distrust in government, not by commitment to a positive ideological program  [@dyck2018]. 

Symbolic values and ideological identifiers have little relationship to individuals' actually held political beliefs [@zaller1992; @mcclosky1984; @ahler2018; @ahler2015; @mason2018]. While ideological identifiers  like "liberal" and "conservative" may be salient to individuals as *identities*, individuals have little idea of what views are typical of a party or ideology and which are heterodox. Partisans' self identification as "moderate" or "extreme" may well inform their disposition towards their party but there is no guarantee that those individuals would recognize those who identify as their "co-ideologues" as such, or even be correct in placing their own views on an ideological spectrum [@converse1964; @kalmoe2020a]. Thus, characterization of partisan groups as internally polarized on the basis of ideology is conceptually fraught given the quality of evidence available [@fiorina2005; @fiorina2012; @ahler2018; @iyengar2012; @iyengar2018].

I argue that ideology alone is insufficient to understand intra-party affect. Rather, I argue that intra-party electoral competition is itself a driver of intra-party affective divisions. In this paper, I draw on cross-sectional data from the American National Elections Study (ANES) and an original survey experiment. I demonstrate that, while cold partisans are less likely to support their own party's candidates they are not disengaged from politics. Rather, cold partisans *are* more skeptical of government, more pessimistic about democracy, and more likely to support third party candidates. 


That Sanders supporters would be antagonistic towards the Democratic Party is not surprising on its own. Sanders campaigned against the party establishment---it is not a stretch that he would attract those disillusioned or unhappy with the party. The story is more complicated. Republican supporters of Donald Trump---whose campaign was even more exuberant in its hostility towards the Republican party establishment than Sanders's was toward the Democrats---were more enthusiastic about their party than any other 2016 candidate's supporters, despite the mutual hostility between Trump and established Republican elites. As is discussed later, in Figure 5, supporters of winning candidates tend to be warmer towards their own party than are losers---there is little difference in distributions of out-party affect. 

# Old Descriptives


Before investigating the role played by primaries in driving intra-party attitudes, I present descriptive findings showing how in-party attitudes have developed over time and the differences between enthusiastic and unhappy partisans. Average in-party feeling thermometers have been remarkably stable since the question first appeared on the ANES in 1978, hovering around a balmy 70 degrees [@iyengar2012; @iyengar2018]. This stable average belies increasing heterogeneity around that mean.

[OLD FIGURE 1] plots the standard deviation of in-party feeling thermometers alongside the percentage of Republicans and Democrats who are cold towards their own in-party (reporting an in-party FT of $\leq{50}$). Rounding to the nearest tenth, in 1978 the standard deviation of the in-party SD (given by the light, dotted line) was $17.5$. By 2016 the standard deviation had increased to $21.9$, a statistically significant, if modest increase. The percentages of cold Democrats and Republicans tell a clearer story. The number of cold Republicans (given by the dark solid line) tripled between 2004 and 2016, rising from $5.7\%$ in 2000 to $18.9\%$ in 2016 rounded to the nearest tenth. The proportion of cold Democrats doubled over this time period, increasing from $4.4\%$ in 2000 to $10.1\%$ in 2016. Even after tapering off from 2016 the percentage of cold Republicans in 2020 was twice as large as in 2000, and almost four times as large as it was in 1978, when a measly $\approx{3}\%$ each of Republicans and Democrats were cold towards their own parties.

These trends in in-party affect reinforce the argument that partisans are not an affective monolith---love for the in-party is not universal within a party, nor is it stable across time. While the majority of partisans remain favorable towards their party at any given time, I argue that even ostensibly small declines in average feeling thermometer scores or small increases in the proportion of cold partisans are substantively significant, and should give pause to both party elites and students of political science.

\clearpage

-->
````
