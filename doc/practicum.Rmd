---
title: "Intra-Party Affect"
author: "Rob Lytle"
output: 
  bookdown::pdf_document2:
  number_sections: TRUE
  fig_caption: TRUE
  
abstract: "How do partisans think about their *own* party? Inter-party affective divisions have been widely identified by scholars of partisanship and public opinion. Increasingly, Republican and Democratic partisans have come to dislike members of their political outgroup. What has been lost in these discussions is an appraisal of individuals perceptions of and attitudes towards their in-party, which are generally held to be both stable and broadly positive. In this study, I leverage time-series survey data to identify substantively meaningful shifts in voters' attitudes towards their own party. Additionally, I conduct an original survey experiment interrogating the role played by primary elections in driving behavioral and attitudinal differences between co-partisans." 
bibliography: references.bib
header-includes:
- \usepackage[margin=1in]{geometry}
- \usepackage{caption}
- \usepackage{multirow}
- \usepackage{amsmath}
- \usepackage{mathrsfs}
- \usepackage{float}
- \usepackage{natbib}
- \bibliographystyle{apsr}
- \usepackage{graphicx}
- \graphicspath{ {../fig/} }
- \usepackage{setspace}
- \usepackage[super]{nth}
- \usepackage{booktabs}
- \usepackage{makecell}
- \usepackage{amsmath}
- \usepackage{dcolumn}
- \usepackage{hyperref}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
library(lubridate)
#library(MASS)
library(brglm)
library(modelsummary)
library(gt)
library(gtsummary)
library(AER)
library(tidyverse) #tidyverse
library(tidymodels)
library(kableExtra) # one way to make tables
library(stargazer) # Another way to make tables (can also output esttab to .tex--examples below)
library(ggExtra)
library(ggridges)
library(gridExtra)
library(ggpubr)
library(cowplot)
set.seed(2001)
theme_set(theme_minimal())
dodge <- position_dodge(width=0.75)


```

```{r, include = FALSE}
tidy_2020_df <- read_rds("data/tidy-2020.rds")%>%
  select(pid_3,
         pid_7,
         year,
         therm_inparty,
         therm_outparty,
#         therm_parties_mean,
         weight)%>%
  filter(pid_3 != "Independent")%>%
  glimpse()


cdf_trimmed <- read_rds("data/tidy-cdf.rds")%>%
  filter(year >= 1978)%>%
  select(pid_3,
         pid_7,
         year,
#         race_4cat,
         therm_inparty,
         therm_outparty,
#         therm_parties_mean,
         weight,
         )%>%
  rbind(tidy_2020_df)%>%
  glimpse()

party_fts_ns <- cdf_trimmed%>% # Making a DF of the party-year SD
  filter(pid_3 != "Independent" & year != 2002)%>%
  select(year,
         weight,
         pid_3,
         therm_inparty,
         therm_outparty,
         pid_7,
         )%>%
  group_by(year, 
           pid_3)%>%
  summarise(mean_in = weighted.mean(therm_inparty, weight, na.rm = TRUE),
            mean_out = weighted.mean(therm_outparty, weight, na.rm = TRUE),
            sd_in = radiant.data::weighted.sd(therm_inparty, weight, na.rm = TRUE),
            sd_out = radiant.data::weighted.sd(therm_outparty, weight, na.rm = TRUE))%>%
  pivot_longer(mean_in:sd_out, names_to = "group", values_to = "result")%>%
  unite("group", pid_3:group)%>%
  ungroup()%>%
  mutate(stat = as.factor(if_else(str_detect(group, "mean"), "mean", "sd")))%>%
  mutate(group = recode(group, .default = group,
                       "Democrat_mean_in" = "Democrat - In Party",
                       "Democrat_mean_out" = "Democrat - Out Party",
                       "Democrat_sd_in" = "Democrat - In Party",
                       "Democrat_sd_out" = "Democrat - Out Party",
                       "Republican_mean_in" = "Republican - In Party",
                       "Republican_mean_out" = "Republican - Out Party",
                       "Republican_sd_in" = "Republican - In Party",
                       "Republican_sd_out" = "Republican - Out Party"))%>%
  glimpse()


below_mct_ns <- cdf_trimmed%>% # MCT = Measure of Central Tendency
#below_mct_ns <- cdf_extended%>% # with 2020
  select(year,
         weight,
         pid_3,
         therm_inparty)%>%
  filter(pid_3 != "Independent" & year != 2002)%>%
  mutate(above_80_dum = if_else(therm_inparty > 80, 1, 0),
         above_75_dum = if_else(therm_inparty > 75, 1, 0),
         above_mean_sd_dum = if_else(therm_inparty > weighted.mean(therm_inparty, weight, na.rm = TRUE) + radiant.data::weighted.sd(therm_inparty, weight, na.rm = TRUE), 1, 0),
         below_50_dum = if_else(therm_inparty < 50, 1, 0),
#         below_mean_dum = if_else(therm_inparty < weighted.mean(therm_inparty, weight, na.rm = TRUE), 1, 0),
#         below_mean_sd_dum = if_else(therm_inparty < weighted.mean(therm_inparty, weight, na.rm = TRUE) - radiant.data::weighted.sd(therm_inparty, weight, na.rm = TRUE), 1, 0),
#         below_med_dum = if_else(therm_inparty < spatstat::weighted.median(therm_inparty, weight, na.rm = TRUE), 1, 0),
#         below_med_sd_dum = if_else(therm_inparty < spatstat::weighted.median(therm_inparty, weight, na.rm = TRUE) - radiant.data::weighted.sd(therm_inparty, weight, na.rm = TRUE), 1, 0)
)%>%
  glimpse()

mct_prop_ns <- below_mct_ns%>% #way more measures here than are needed
  group_by(year, pid_3)%>%
  summarise(#prop_mean_below = weighted.mean(below_mean_dum, weight, na.rm = TRUE),
            #prop_mean_sd_below = weighted.mean(below_mean_sd_dum, weight, na.rm = TRUE),
#            prop_med_below = weighted.mean(below_med_dum, weight, na.rm = TRUE), #prop_below is those below the MCT, prop_sd_below is those one SD below med
#            prop_med_below_sd = weighted.mean(below_med_sd_dum, weight, na.rm = TRUE),
            prop_50_below = weighted.mean(below_50_dum, weight, na.rm = TRUE),
            prop_80_above = weighted.mean(above_80_dum, weight, na.rm = TRUE),
            prop_75_above = weighted.mean(above_80_dum, weight, na.rm = TRUE),
#            prop_mean_sd_above = weighted.mean(above_mean_sd_dum, weight, na.rm = TRUE),
#            se_mean_below = diagis::weighted_se(below_mean_dum, weight, na.rm = TRUE),
#            se_mean_sd_below = diagis::weighted_se(below_mean_sd_dum, weight, na.rm = TRUE),
#            se_med_below = diagis::weighted_se(below_med_dum, weight, na.rm = TRUE),
#            se_med_sd_below = diagis::weighted_se(below_med_sd_dum, weight, na.rm = TRUE),
            se_50_below = diagis::weighted_se(below_50_dum, weight, na.rm = TRUE),
            se_80_above = diagis::weighted_se(above_80_dum, weight, na.rm = TRUE),
#            se_mean_sd_above = diagis::weighted_se(above_mean_sd_dum, weight, na.rm = TRUE)
  )%>%
  glimpse()

n_df_ns <- cdf_trimmed%>% # Making a DF of the party-year SD
  filter(pid_3 != "Independent" & year != 2002)%>%
  select(year,
         weight,
         pid_3,
         therm_inparty,
         therm_outparty)%>%
  group_by(year, pid_3)%>%
  summarise(n = n(),
            mean_in = weighted.mean(therm_inparty, weight, na.rm = TRUE),
            mean_out = weighted.mean(therm_outparty, weight, na.rm = TRUE),
            sd_in = radiant.data::weighted.sd(therm_inparty, weight, na.rm = TRUE),
            sd_out = radiant.data::weighted.sd(therm_outparty, weight, na.rm = TRUE))%>%
  glimpse()


df_for_sampling <- cdf_trimmed%>% # Making a DF of the party-year SD
  filter(pid_3 != "Independent" & year != 2002)%>%
  select(year,
         weight,
         pid_3,
         therm_inparty,
         therm_outparty,
         pid_7
  )%>%
glimpse()


#bootstrapping the SE of the SD
boot_sd_in <- data.frame(boot = 1:500)%>%
  group_by(boot)%>%
  do(sample_n(df_for_sampling, 
              nrow(df_for_sampling),
              replace = TRUE))%>% #creating 100 new datasets of equal size to the original
  group_by(boot,
           year,
           pid_3)%>%
  summarise(mean_in = weighted.mean(therm_inparty, weight, na.rm = TRUE),
            mean_out = weighted.mean(therm_outparty, weight, na.rm = TRUE),
            sd_in = radiant.data::weighted.sd(therm_inparty, weight, na.rm = TRUE),
            sd_out = radiant.data::weighted.sd(therm_outparty, weight, na.rm = TRUE))%>%
  group_by(year,
           pid_3)%>%
  summarise(se_mean_in = sd(mean_in),
            se_mean_out = sd(mean_out),
            se_sd_in = sd(sd_in),
            se_sd_out = sd(sd_out))%>%
  pivot_longer(se_mean_in:se_sd_out, names_to = "group", values_to = "result")%>%
  unite("group", pid_3:group)%>%
  mutate(stat = as.factor(if_else(str_detect(group, "mean"), "se_mean", "se_sd")))%>%
  mutate(group = as.factor(recode(group,
                                  "Democrat_se_mean_in" = "Democrat - In Party",
                                  "Democrat_se_mean_out" = "Democrat - Out Party",
                                  "Democrat_se_sd_in" = "Democrat - In Party",
                                  "Democrat_se_sd_out" = "Democrat - Out Party",
                                  "Republican_se_mean_in" = "Republican - In Party",
                                  "Republican_se_mean_out" = "Republican - Out Party",
                                  "Republican_se_sd_in" = "Republican - In Party",
                                  "Republican_se_sd_out" = "Republican - Out Party")))%>%
  glimpse()

  
party_fts_ns_joined <- rbind(party_fts_ns, boot_sd_in)%>%
#party_fts_ns_joined <- full_join(party_fts_ns, boot_sd_in)%>%
  pivot_wider(names_from = stat,
              values_from = result)%>%
  glimpse()

## Primaries Wrangling


df_primaries <- read_rds("data/tidy-primaries.rds")%>%
	filter(pid_3 != "Independent" & !is.na(primary_vote_simple))%>%
	filter(!(pid_3 == "Republican" & primary_vote_simple == "Loser" & year == 2020))%>% # dropping republicans who didn't vote for trump because there are very few.
	mutate(primary_vote_simple = recode(primary_vote_simple, .default = levels(primary_vote_simple),
																			"Didn't Vote" = "Other/Third Party/\n Didn't Vote",
																			"Voted in Other Party Primary" = "Other/Third Party/\n Didn't Vote"))%>%
	filter(primary_vote_simple != "Other/Third Party/\n Didn't Vote")%>%
	mutate(primary_vote_simple = factor(primary_vote_simple,
																			levels = c("Winner", "Loser")))%>%
	glimpse()

df_out_means <- df_primaries%>%
	group_by(primary_vote_simple, year, pid_3)%>%
	summarize(mean_ft = weighted.mean(therm_outparty, weight, na.rm = TRUE))%>%
	glimpse()

	###
	# Inparty FT
	###
df_in_means <- df_primaries%>%
	group_by(primary_vote_simple, year, pid_3)%>%
	summarize(mean_ft = weighted.mean(therm_inparty, weight, na.rm = TRUE))%>%
	glimpse()

df_out_means <- df_primaries%>%
	group_by(primary_vote_simple, year, pid_3)%>%
	summarize(mean_ft = weighted.mean(therm_outparty, weight, na.rm = TRUE))%>%
	glimpse()



```

\doublespacing

# Introduction

Polarization


## Affective polarization introduction


In 2008, despite her position as Democratic standard-bearer, supporters of Hillary Clinton's primary campaign were colder towards their party than any other group of Democratic primary voters on the ANES 100-point Feeling Thermometer. Clinton's defeat by Barack Obama in June of 2008 spawned the "Party Unity My Ass" movement, which engaged in various forms of protest against the DNC and pledging *en masse* not to support the (relative) party outsider Barack Obama in the general election^[https://www.washingtonpost.com/wp-dyn/content/article/2008/06/26/AR2008062604162.html?tid=a_inl_manual].
Clinton supporters' posture towards their party in 2016 bore little semblance to that of the '08 race. Bernie Sanders---a former independent and self-identified socialist---leaned into the role of an insurgent, anti-establishment candidate; predicating his campaign on a conflict between the working-class and the elites of both major parties. Sanders supporters, angry with the DNC and reluctant to support Clinton in November led a loosely organized movement of Democratic party discontents to found groups like *Justice Democrats* and expand membership of organizations like the *Democratic Socialists of America* and various state and local progressive caucuses to protest perceived slights by the party establishment and support further left and anti-establishment down-ballot candidates. 

This is not particularly surprising on its own. Sanders campaigned against the party establishment---it is not a stretch that he would attract those disillusioned or unhappy with the party. The story is more complicated. Republican supporters of Donald Trump---whose campaign was even more exuberantly hostile towards the Republican party than Sanders' was toward the Democrats---were *warmer* towards their party than any other candidates' supporters, despite the mutual hostility between Trump and established Republican elites. As shown in Fig. 1, supporters of winning candidates tend to be warmer towards their own party than are losers---there is little difference in distributions of out-party affect.


## Partisanship

Many scholars have noted a decline in positive feelings towards members of other political parties [@iyengar2012, @ahler2018, @iyengar2018, @mason2015]. The downward spiral of attitudes towards the out-party (and political out-groups more generally) is almost always discussed in the context of "affective polarization" in the mass public, a process by which partisans grow to "increasingly dislike, even loathe, their opponents" [@iyengar2012]. Scholars of political polarization have paid far less attention to the attitudes of partisans towards their own party, which are generally held to be overwhelmingly warm within parties and stable across time. @iyengar2018 goes as far as to argue that attitudes towards one's own party are largely unimportant in informing political behavior.

Recent work has challenged the monolithic characterization of intra-party attitudes. @groenendyk2020 argues that intra-party polarization is occuring along ideological lines as more self-identified moderate Democrats and Republicans become less enthusiastic about their parties while their co-partisans on the left and right respectively grow more favorable towards the party. While I enthusiastically agree that intra-party attitudes are more heterogeneous than is typically thought, I am skeptical that partisans' ideology is a driving force behind increasing in-party heterogeneity. 

The accuracy of ideological self-assessments is dubious. Symbolic values and ideological identifiers have little relationship to individuals' actually held political beliefs [@zaller1992, @mclosky1984, @ahler2018, @ahler2015 @mason2018]. Individuals have little idea of what views are typical of a party or ideology and which are heterodox. Partisans self identification as "moderate" or "extreme" may well inform their disposition towards their party but there is no guarantee that those individuals would recognize those  who identify as their "co-ideologues" as such. Thus, characterization of parties as internally ideologically polarized is conceptually fraught given the evidence available.

Setting aside the issue of unreliable ideological self reports, there is reason to doubt that the extreme wings of the parties are the most enthusiastic supporters. Particularly since the 2016 Democratic Primaries, journalism and scholarship has been rife with accounts of the animosity exhibited by the activists and elected officials on the party's left towards the more centrist mainline of the party [@azari2017, @thompson2020]. @masket2020 details lingering animosity between supporters and staffers for the 2016 campaigns of Bernie Sanders and Hillary Clinton (as well as a disdain for individuals associated with the Sanders campaign expressed by former Martin O'Malley organizers). Additionally, supporters of the 2016 Sanders and Trump candidacies were motivated largely by distrust in government [@dyck2018].

Particularly in the Democratic Party context it is difficult to square the ideological polarization proposed by -@groenendyk2020 with the qualitative features of the visible power struggle within the party.

## Primaries


Vote choice&mdash;or preference for a candidate more generally&mdash;are most often analyzed as the outcome of (potential) voters' preferences and evaluations of candidates' attributes. That primary voters choose their candidate in part to safeguard group cohesion in their party [@wronski2018; @bankertforthcoming] begs the question: what happens to the group when candidates lose? How do partisans react when the preferences of some in the party are advantaged above their own? Scholars of policy feedback have found citizens who perceive themselves as being cut out of government decision making processes to be more disaffected and less participatory in democratic political activities [@soss1999; @bruch2010]. Not only do individuals assess individual programs and actors on the basis of their (perceived) inclusiveness, assessments of individuals' own roles and place in political society are conditioned in part by signals they receive from political and policy actors [@campbell2012]. I argue that this is likely to hold true in the context of primary elections. Primary voters who perceive their party working against their preferred candidate should become more distrusting of political elites and display less affinity for their own party. 

Party elites may not be *government* policymakers or bureaucrats, but they are certainly *political* actors; their sphere of policy influence is simply constrained to the internal workings of one party&mdash;not the government writ-large. It is unlikely that the blurry distinction between "government" and "political" matters all that much to the rationally ignorant median voter as they assimilate political information and update their evaluations of elites and themselves. Moreover, government employees and party apparatchiks each wield considerable power shaping possible policy outcomes. Insofar as disaffection stems from being "cut out" of the policy process it is not clear that the legal distinction between government and party *should* be affectively salient to observers, political sophisticates or not. Further, primary elections are programs designed and implemented by a vast bureaucracy of national and state parties, private information systems providers, federal government regulators, and local supervisors of elections; structurally similar to many federated programs, even if the primary bureaucracy only becomes salient to the public every two or four years at best. 

In light of these structural similarities, it is worth asking how well insights from the policy feedback literature travel to the context of candidate selection. Theoretically, public perceptions of exclusionary politicking or unfair treatment of candidates by party elites should depress voters' assessment of the nominating process and their affection for the party. Such perceptions signal to the individual both that they hold little power in the nominating process and that those partisan actors who are powerful do not represent the interests of the powerless primary voter in question. In a policy feedback framework, the primary voter perceives a top-heavy, paternalistic party organization and has internalized their own un-belonging within that organization. Concomitant with their declining trust, disaffected partisans have little incentive (whether material or group-motivated) to participate in political activity.

In the presidential context, a primary loss is a rebuke of the preferences of losers supporters and the ascension of the representative of an *outgroup* to the station *de facto* leader of the *in-party*. During the primary season, a primary voter's in-group is not only their fellow Democrats or Republicans, but fellow Sanders, Warren, and Buttigieg; Trump, Cruz, and Rubio voters as well. Those supporters of the opposing primary candidates then constitute an out-group *within* the party, the salience of which is endogenous to the affective tenor of the primary and the degree to which the candidates distinguish themselves from the opposition.



# Trends in Partisan Affect

My analysis of intra-party attitudes begins by taking a broad view of trends in partisan's attitudes for their own party and its opposition. Figure 1 uses data from the American National Election Study (ANES) to show the mean in-party and out-party feeling thermometers from 1978 to 2020, the full time range over which the partisan feeling thermometer question is included on the ANES^[Pre-1978 iterations of the ANES study include some feeling thermometer questions, but ask respondents to rate "Democrats and Republicans", rather than the "Democratic and Republican Parties". In years where both questions are asked there are considerable differences in mean thermometer ratings---the questions are not equivalent to one another.]. As identified by @iyengar2012 and @iyengar2018, the decline in warmth towards the out-party is notable. From 2004--2020 mean out-party attitudes dropped from an already chilly $\approx{40}$ to $\approx 20$. 


```{r cdf-means, fig.cap="Time-series shifts in partisan affect."}

gg_mean_ft_ns <- ggplot(party_fts_ns_joined, aes(x = year, y = mean)) +
#  geom_smooth(aes(linetype = group, color = group), span = .3, se=F) +
  geom_line(aes(linetype = group, color = group), position = dodge) +
#  geom_linerange(aes(ymin = mean-sd, ymax = mean+sd, color = group), position = dodge) +
  geom_point(aes(shape = group, color = group), size = 3, position = dodge) +
  scale_linetype_manual(values = c("Democrat - In Party" = "longdash",
                                   "Democrat - Out Party" = "dotted",
                                   "Republican - In Party" = "solid",
                                   "Republican - Out Party" = "twodash")) +
  scale_shape_manual(values = c("Democrat - In Party" = 17,
                                   "Democrat - Out Party" = 2,
                                   "Republican - In Party" = 16,
                                   "Republican - Out Party" = 1)) +
  scale_color_manual(values = c("Democrat - In Party" = "dodgerblue4",
                                   "Democrat - Out Party" = "dodgerblue1",
                                   "Republican - In Party" = "firebrick4",
                                   "Republican - Out Party" = "firebrick1")) +
  #scale_x_continuous(limits = c(1978,2020), breaks = c(0:5)) +
  scale_x_continuous(breaks = seq(1976, 2020, by = 4)) +
  scale_y_continuous(breaks = seq(0, 100, by = 10), limits = c(0,100)) +
  labs(y = "Mean",
       x = "Year",
       title = "Mean Thermometer Ratings of Partisans",
       subtitle = "Includes Leaning Independents",
       linetype = " ",
       color = " ",
       shape = " ") +
  theme(legend.position = c(0.2, 0.2)) +
  guides(size = FALSE
#         shape = guide_legend(override.aes = list(size = 1.5))
         )
gg_mean_ft_ns
```

Out-party attitudes are only one side of partisan affect. Attitudes towards the in-party are certainly much more favorable than those towards the out-party but are still subject to variation. Most obviously, Republicans' mean in-party thermometer dropped by $\approx{10}$ points between 2004 and 2016, before rebounding to Bush-era highs during the 2020 election cycle. Democrats' mean thermometer rating also dropped over this time period, though by a much smaller amount than that of their Republican counterparts.

Despite some recent turbulence these mean partisan feeling thermometers largely support the view that in-party attitudes are positive and stable. A focus on mean values belies the heterogeneity which exists in the distributions of partisan affect across survey-years. Figure 2 shows the standard deviation of in-party feeling thermometer in each survey-year of the ANES along with the bootstrapped 95\% confidence interval for each. 

```{r cdf-sd, fig.cap="Changes in the standard deviation of in-party feeling thermometers."}

test_df <- party_fts_ns_joined%>%
  filter(year == 2000 | year == 2020)%>%
  filter(group == "Democrat - In Party")

df_2000 <- rnorm(500, mean = 18.39896, sd = 0.5377489*sqrt(500))



gg_sd_ft_ns <- party_fts_ns_joined%>%
  filter(!str_detect(group, "Out"))%>%
  ggplot(aes(x = year, y = sd, color = group)) +
#  geom_smooth(aes(linetype = group), span = .3, se=F) + 
  geom_line(aes(linetype = group), size = 1, position = dodge) +
#  geom_errorbar(aes(ymin = sd - 1.96*se_sd, ymax = sd + 1.96*se_sd), width = 2, position = dodge) +
  geom_linerange(aes(ymin = sd - 1.96*se_sd, ymax = sd + 1.96*se_sd, color = group), position = dodge) +
  geom_point(aes(shape = group), position = dodge, size = 3) +
  scale_linetype_manual(values = c("Democrat - In Party" = "longdash",
                                   "Republican - In Party" = "solid")) +
  scale_shape_manual(values = c("Democrat - In Party" = 17,
                                "Republican - In Party" = 16)) +
  scale_color_manual(values = c("Democrat - In Party" = "dodgerblue4",
                                "Republican - In Party" = "firebrick4")) +
  #scale_x_continuous(limits = c(1978,2020), breaks = c(0:5)) +
  scale_x_continuous(breaks = c(seq(1978, 2000, by = 2),
                                seq(2004, 2020, by = 4)), guide = guide_axis(n.dodge = 2)) +
#  scale_y_continuous(limits = c(14,25)) +
  labs(y = "Standard Deviations",
       x = "Year",
       title = "Standard Deviation of In-Party Feeling Thermometers",
       subtitle = "Includes Leaning Independents",
       linetype = " ",
       color = " ",
       shape = " ",
       caption = "Bootstrapped 95% CI Given By Vertical Bars") +
  theme(legend.position = c(0.2, 0.8),
        legend.key.width = unit(.1, "npc"),
        legend.key.height = unit(.075, "npc")) +
  guides(size = "none")
gg_sd_ft_ns

```


As shown in figure 2, the standard deviation of in-party feeling thermometers has increased significantly between 2004 and 2016. Though the standard deviations of both Democrats' and Republicans' scores tapered off slightly in 2020, exhibiting more variation than at any other (non-2016) point since 1978. 


One source of this increased variation is the increasing number of partisans who are cold towards their party.

```{r below-50, echo = FALSE, fig.cap="Proportion of cold partisans by party-year"}
gg_below_50_ns <- ggplot(mct_prop_ns, aes(x = year, y = prop_50_below)) +
  geom_line(aes(linetype = pid_3, color = pid_3), position = dodge, size = 1) + 
  #  geom_smooth(aes(linetype = pid_3_sort, color = pid_3_sort), span = .3, se = FALSE) +
  geom_linerange(aes(color = pid_3, ymin = prop_50_below - 2*se_50_below, ymax = prop_50_below + 2*se_50_below), position = dodge) +
  geom_point(aes(shape = pid_3, size = 1, color = pid_3), position = dodge) +
  scale_color_manual(values = c("Democrat" = "dodgerblue4",
                                "Republican" = "firebrick4")) +
  scale_linetype_manual(values = c("Democrat" = "longdash",
                                   "Republican" = "solid")) +
  theme(legend.position = c(0.1, 0.7)) +
  guides(size = "none") +
  labs(x = "Year", 
       y = "Proportion",
       color = "Party ID",
       linetype = "Party ID",
       shape = "Party ID",
       title = "Proportion of Partisans Below 50 In-Party FT",
       subtitle = "95% CI Given With Errorbar") #+
#  facet_wrap(vars(pid_str))
gg_below_50_ns

```

As variance increases, so to has the proportion of partisans who rate their own party below a 50---an inherently meaningful threshold indicating that partisans are more cold than warm toward their own party. As shown in figure 3, 10% of Democrats and almost 20% of Republicans are found to be cold towards their own party in 2016 (up from 5% each in 2004). The prevalence of intra-party coldness held steady among Democrats into the 2020 election cycle, but dropped precipitously among Republicans.

These trends in in-party affect reinforce the argument that partisans are not an affective monolith---love for the in-party is not universal within a party, nor is it stable across time. More notably, this temporal instability is itself increasing. While the majority of partisans remain favorable towards their party at any given time, I argue that even ostensibly small declines in average feeling thermometer scores or small increases in the proportion of cold partisans are substantively significant, and should give pause to both party elites and students of political science

## Differences Between Cold and Warm Partisans

I turn now to an examination of attitudinal and behavioral differences between cold and warm partisans. Partisan warmth is a somewhat abstract concept. Survey respondents may be thinking of any number of attitudes and dispositions towards any number of groups and individuals when reporting their "warmth" towards "the party". Because of this fuzzy conceptualization, the importance of studying partisan warmth is largely dependent on the degree to which partisan affect is related to more concrete sets of behaviors and opinions.

```{r ft-difs, fig.height=8.5, fig.width=4, fig.align='center', fig.caption = "Differences in attitude and behavior between cold and warm partisans."}

#First calling the bootstrapped dfs written in plots-ft-dif-strict.R


behavior_pooled_df <- read_rds("data/tidy-behavior.rds")

opinion_pooled_df <- 	read_rds("data/tidy-opinion.rds")


gg_strict_opinion_pooled <- ggplot(opinion_pooled_df, aes(x = prop_difference_simple, y = fct_relabel(which_question_simple, str_wrap, width = 20))) +
  	geom_vline(xintercept = 0.00) +
	geom_linerange(aes(xmin = prop_difference_simple - 1.96*simple_prop_se, xmax = prop_difference_simple + 1.96*simple_prop_se, color = pid_3), position = dodge) +
	#	geom_point(data=opinion_pooled_df[opinion_pooled_df$sig_dum == TRUE,],size=5, aes(position = pid_3), shape = 1, position = dodge) + #overlays a shape on sig 
	geom_point(aes(color = pid_3, shape = pid_3), size = 3, position = dodge) +
	scale_color_manual(values = c("Democrat" = "dodgerblue3",
																"Republican" = "firebrick3")) +
	coord_cartesian(xlim = c(-.75, .75)) +
	scale_x_continuous(n.breaks = 6) +	
	labs(x = "Difference",
			 y = "Question",
			 #			 title = "Difference in Proportion Whom Agree\n between Cold/Warm Partisans",
			 subtitle = "Opinion Items",
			 color = "Party",
			 shape = "Party")



gg_strict_behavior_pooled <- ggplot(behavior_pooled_df, aes(x = prop_difference_simple, y = fct_relabel(which_question_simple, str_wrap, width = 20))) +
  	geom_vline(xintercept = 0.00) +
	geom_linerange(aes(xmin = prop_difference_simple - 1.96*simple_prop_se, xmax = prop_difference_simple + 1.96*simple_prop_se, color = pid_3), position = dodge) +
	#	geom_point(data=behavior_pooled_df[behavior_pooled_df$sig_dum == TRUE,],size=5, aes(position = pid_3), shape = 1, position = dodge) + #overlays a shape on sig 
	geom_point(aes(color = pid_3, shape = pid_3), size = 3, position = dodge) +
	scale_color_manual(values = c("Democrat" = "dodgerblue3",
																"Republican" = "firebrick3")) +
	coord_cartesian(xlim = c(-.75, .75)) +
	scale_x_continuous(n.breaks = 10) +	
	theme(legend.position = c(0.8, 0.3)) +
	labs(x = "Difference",
#			 y = "Question",
			 y = " ",
			 subtitle = "Behavior and Knowledge Items",
			 caption = "Bootstrapped 95% CI given by horizontal bars \n Cold Partisans < 50 inparty FT, Warm >= 70",
			 color = "Party",
			 shape = "Party")


#####
## Putting them into one plot
#####

#Removing redundant formatting from the plots
p1 <- gg_strict_opinion_pooled + theme(legend.position = "none",
																axis.title.x = element_blank(),
																axis.title.y = element_blank(),
																axis.text.x = element_blank())
p2 <- gg_strict_behavior_pooled + theme(
	axis.title.x = element_blank(),
	axis.title.y = element_blank())

pg <- plot_grid(p1, p2,  align = "v", nrow = 2, rel_heights = c(3/7, 4/7), label_x = "Difference") 



gg_strict_pooled_combined <- grid.arrange(arrangeGrob(pg,
																							 top = text_grob("Difference in Proportion Between Cold and Warm Partisans", vjust = 1, face = "bold"),
																							 left = text_grob("Question Asked", rot = 90, vjust = 1, face = "bold"),
																							 bottom = text_grob("Cold - Warm", face = "bold")))

```

Figure 4 displays the difference in the proportions of cold and warm partisans who indicate agreement with (or answer in the affirmative to) a variety of questions regarding their political opinions and behaviors. Positive values indicate a higher proportion of cold partisans agree with a statement or report a certain behavior while negative values indicate warm partisans are more likely to agree with a statement or report engaging in a behavior.

These data are drawn from the ANES cumulative data file (ANES-CDF) and 2020 time-series study, pooling all years from 1978-2020. Proportions were calculated in accordance with the ANES-CDF variable codebook^[https://electionstudies.org/anes_timeseries_cdf_codebook_var/]. The 6-item campaign participation index is taken  from item `VCF0723` in the ANES cumulative data file. This variable is the sum of the number of campaign-related activities a respondent indicated participation in during a given election cycle---plus one---such that "$1$" indicates no campaign participation and "$6$" indicates participation in each type of activity inquired of by the interviewer. To make the difference-in-means for this item comparable with each of the difference-in-proportions calculated, the variable was rescaled such that all respondents fall in $[0,1]$ before taking the difference of the mean responses for the cold and warm groups. 

Cold partisans of both parties consistently express more pessimism about the direction of the country and the way the government is run. Cold Democrats and Republicans are more likely distrust the government, hold the country to be "on the wrong track", believe that officials do not value their opinion, and see government as being run for a few people at the top. Cold Democrats are more likely than their warm co-partisans to be dissatisfied with Democracy and cold Republicans are more likely to believe that the wealth gap is greater at the time of their interview than it was 20 years ago. There was no significant difference between cold and warm Democrats' beliefs about the wealth gap, nor was there a significant difference between Republicans' satisfaction with Democracy.

The differences between affect groups on the behavior and knowledge items are more varied. Cold partisans are more likely to vote for a major outparty presidential candidate and to vote for third-party in Presidential races.There is no significant difference in the proportion of cold and warm partisans who know which party controlled the house before the most recent election, who report talking about politics most days, or in their mean participation scores. Even more surprising, cold partisans were just as likely as warm partisans to report voting in both primary elections and general elections. For their part, warm partisans were more likely to watch campaign related TV and (unsurprisingly) to vote in-party for House and Presidential races.




Finally, for some items very few respondents answered in the affirmative (or reported low levels of the item as in the case of the 6-item participation index) exaggerating the apparent differences between cold and warm groups. To ensure that apparent differences betweeen groups were not a product of low participation *across* groups, an alternative version of figure 4 normalizes each difference by dividing the proportional difference by the sum of the means of both groups. This alternative version of figure 4 is available in the appendix.

$$
\frac{\mu_{cold} - \mu_{warm}}{\mu_{cold} + \mu_{warm}}
$$

This alternative calculation does little to change the items on which statistically significant differences are found, the only change in significance is found in the proportion of partisans watching campaign television. When the normalized difference is used there is no statistically significant difference in the campaign TV watching habits of cold and warm partisans.

These group differences hold important implications for politicians and party leaders who may be tempted to write off cold partisans as disengaged, low-information, or as pushovers who may put up a fuss but hold their noses and vote for the party when the time comes. Choosing not to respond to the complaints of unhappy partisans could cost candidates valuable votes. Particularly in an era defined by razor-thin margins in the House and Senate, small shifts in partisan turn-out can have dramatic electoral ramifications.

## Primaries

```{r ridge-plot, eval = FALSE}

# Might ditch this for the plot of prop cold
ridge_df_all <- cdf_trimmed%>%
#ridge_df_all <- cdf_extended%>%
  filter(year != 2002)%>%
  mutate(year_fct = fct_rev(as.factor(year)))

ggplot(ridge_df_all, aes(x = therm_inparty, y = year_fct, fill = stat(x), color = "white")) +
  geom_density_ridges_gradient(scale = 3, rel_min_height = 0.02, gradient_lwd = 1) +
  coord_cartesian(clip = "off") +
  scale_x_continuous(limits = c(0,100), breaks = seq(0, 100, by = 10)) +
  scale_fill_gradient(
    low = "blue1",
    high = "red4"
  ) +
  scale_discrete_manual(aesthetics = "color",
                        values = c("white")) +
  geom_vline(xintercept = 50, color = "white") +
  guides(color = "none",
         fill = "none") +
  labs(title = "Changing distribution of in-party feeling thermometers",
       subtitle = "All Respondents",
       y = "Year",
       x = "Feeling Thermometer",
       caption = " ") +
  theme(#panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_blank())
```


```{r primaries-plots, echo=FALSE,warning=FALSE}
gg_primary_in <- ggplot(df_primaries, aes(x = therm_inparty, color = primary_vote_simple, linetype = primary_vote_simple)) +
	geom_density(size = 1.1,
							 alpha = 1) +
	facet_grid(rows = c(vars(year)), 
						 cols = c(vars(pid_3))) +
#	geom_vline(aes(color = primary_vote_simple, xintercept = mean(therm_inparty, na.rm = TRUE)))
	geom_vline(data = df_in_means, 
						 aes(xintercept=mean_ft, 
								 color = primary_vote_simple,
								 linetype = primary_vote_simple),
						 size = 1,
						 alpha = .5) +
	theme(legend.key.height = unit(.05, "npc"),
				legend.position = c(.15, .55),
				legend.text = element_text(size = 8),
				legend.title = element_text(size = 8),
				plot.title = element_text(hjust = 0.5)) +
	scale_color_manual(values = c("Winner" = "#FFC20A", #colorblind safe palette
										 "Loser" = "#0C7BDC"))+
	scale_linetype_manual(values = c(
																	 "Winner" = "longdash",
																	 "Loser" = "dotted")) +
	labs(x = "Inparty FT",
			 y = "Density",
			 title = "In Party",
			 color = "Primary Vote",
			 linetype = "Primary Vote")

gg_primary_out <- ggplot(df_primaries, aes(x = therm_outparty, color = primary_vote_simple)) +
	geom_density(size = 1.1, aes(linetype = primary_vote_simple)) +
	facet_grid(rows = vars(year), 
						 cols = vars(pid_3)) +
#	facet_grid(year ~ pid_3) +
	#	geom_vline(aes(color = primary_vote_simple, xintercept = mean(therm_inparty, na.rm = TRUE)))
	geom_vline(data = df_out_means, 
						 aes(xintercept=mean_ft, 
						 		color = primary_vote_simple,
						 		linetype = primary_vote_simple,
						 		alpha = .5),
						 size = 1) +
	theme(legend.key.height = unit(.05, "npc"),
				legend.position = c(1, .9), # legend position optimized for the two plots together
				legend.text = element_text(size = 8),
				legend.title = element_text(size = 8),
				plot.title = element_text(hjust = 0.5)) +
	guides(alpha = FALSE) +
	scale_color_manual(values = c("Winner" = "#FFC20A", #colorblind safe palette
																"Loser" = "#0C7BDC"))+
	scale_linetype_manual(values = c(#"Other/Third Party/\n Didn't Vote" = "solid",
																	 "Winner" = "longdash",
																	 "Loser" = "dotted")) +
	labs(x = "Outparty FT",
			 y = "Density",
			 title = "Out Party",
			 color = " ",
			 linetype = " ")

#putting them together

p1 <- gg_primary_in + theme(legend.position = "none",
														axis.title.x = element_blank(),
													  axis.title.y = element_blank(),
														axis.text.y = element_blank(),
												#		title = element_text(size = 8)
														)


p2 <- gg_primary_out + theme(
	axis.title.x = element_blank(),
	axis.title.y = element_blank(),
	strip.text.y = element_blank()
#	title = element_text(size = 8)
)



grid.arrange(arrangeGrob(p2, p1,
																				 ncol = 2,
																				 top = text_grob("Distribution of Partisan Warmth\n by Primary Vote", vjust = 1, face = "bold"),
																				 left = text_grob("Density", rot = 90, vjust = 1, face = "bold"),
																			   bottom = text_grob("Feeling Thermometer", face = "bold")))


```
[TABLE I] presents the results of four simple linear regression models, estimating in-party and out-party feeling thermometers as a function of primary election outcome and survey-year control variables. [CITE THINKING SERIOUSLY ABOUT TIME] These results should not be used to predict precise marginal effect sizes for primary loss, but to establish directionality, showing numerically what [FIGURE] shows visually---supporting a losing candidate is associated with lower in-party feeling thermometers in both Republicans and Democrats. 

Curiously, losing Democrats were slightly colder towards Republicans than their victorious co-partisans. There are several possible explanations for this feature which invite further study. First, partisans more likely to support losing candidates may also consider themselves more ideologically extreme, thus perceiving a larger ideological gap between their party and the out-party. This explanation is unconvincing.
```{r primaries-table}
gm_3 <- tibble::tribble(
  ~raw,        ~clean,          ~fmt,
  "nobs",      "N",             0,
  "r.squared", "R Sq.", 2,
  "adj.r.squared", "Adj. R Sq.", 2)

# not including ideology var because this  is probably just a proxy for partisanship
cm_3 <- c("primary_vote_simpleLoser" = "Primary Loss",
          "year2012" = "2012",
          "year2016" = "2016", 
          "year2020" = "2020",
          "(Intercept)" = "Constant") 

df_primaries%>%
  pivot_longer(cols = c(therm_inparty, therm_outparty),
               names_to = "therm_name",
               values_to = "therm_val") %>%
  mutate(therm_name = recode(therm_name,
                             "therm_inparty" =  "In-party",
                             "therm_outparty" = "Out-Party"),
         group_name = paste(therm_name,
                            pid_3,
                            sep = " - "),
         ) %>% 
  group_by(group_name,
           pid_3,
           therm_name)%>%
  nest_by() %>% 
  mutate(fit = list(lm(therm_val ~ primary_vote_simple + year, data = data,  weights = weight)))%>%
  pull(fit, name = c(pid_3))%>%
  modelsummary(output = "gt",
               gof_map = gm_3,
               coef_map = cm_3,
               stars = TRUE) %>% 
  tab_spanner(columns = 2:3, label = "In-Party") %>% 
    tab_spanner(columns = 4:5, label = "Out-Party")

```



Were ideology a principal factor driving partisan affect, we should expect to see greater differences in the out-party density curves presented in [FIGURE]. For example, the vast majority of Democratic respondents in the 2008 ANES supported either Barack Obama or Hillary Clinton; despite Obama's presentation as a progressive alternative to Hillary Clinton from the left-wing of the party, there is essentially no difference in the distributions of out-party feeling thermometers between supporters of Clinton and Obama. Similarly, supporters of Bernie Sanders---a socialist---should be more ideologically distant from Republicans than their non-socialist peers, yet the out-party feeling thermometers of Sanders supporters were slightly higher on average than those of Clinton supporters in 2016.

A more credible possibility is that primary losing partisans are simply more pessimistic about politics in general reporting colder inter-party affect as a result. As shown in [FIGURE], cold partisans are on average more pessimistic about the role of government, democracy, and the direction of the country. Such an explanation would dovetail neatly with recent scholarship which argues that what is often identified as inter-party affective polarization is better characterized as disdain for partisanship and political weariness more generally [@klar2018]. 

The cross-sectional, observational data collected from the ANES show convincingly that there are affective differences  between primary winners and losers, but these analyses are limited in several crucial ways. First, using cross sectional data, we cannot distinguish between a world in which voters who dislike their party are more likely to favor candidates with dim electoral prospects. This is certainly plausible in the primary context in which the vast majority of voters are registered members of the relevant party [maybe add more here?]. The data presented above give us reason to doubt this hypothesis, as even supporters of of pro-party candidates (e.g., Hillary Clinton in 2008) exhibited hostility towards their party after the primary while supporters of the famously party-oppositional Donald Trump were among the most enthusiastic Republicans after the 2016 Primary.

Second, even if causal precedence could be established, these data do not allow us to disentangle the impact of a primary win from a primary loss. As there is no untreated reference category who hold preferences for a primary candidate but who are unaware of the *results* of the primary, differences between winning and losing groups could follow from increased warmth among winners or coldness among losers. 

## Panel Study

To overcome this observational equivalence, I first draw on a panel study conducted as part of the 2008 National Annenberg Election Survey (NAES) by the Annenberg Public Policy Center. Respondents were surveyed across five waves from October 7, 2007 (pre-primary) to January 31, 2009 (post-innauguration). These panel data allow us to overcome the problem of observational equivalence inherent to cross-sectional data by estimating the treatment effect of supporting a losing candidate before and after their loss is apparent. 

As the 2008 NAES does not solicit partisan feeling thermometers from respondents strong partisanship is used as an imperfect proxy for a partisan feeling thermometer on the grounds that those who identify as strong partisans unsurprisingly tend to report higher in-party feeling thermometers than their less strong and leaning co-partisans^[A table and figure which use ANES data to support this assumption are made available in this study's supporting information.].


```{r, include=FALSE}

gg_three_wave_df <- read_rds("data/gg-three-wave-str.rds")%>%
  select(pid_3_1,
         first_choice_dum_1,
         wave_presump,
         wave,
         prop_strong,
         se_strong)%>%
  mutate(wave_norml = recode(wave_presump,
                               "Before Presumptive" = "Wave 2 - Wave 1",
                               "After Presumptive" = "Wave 3 - Wave 2"),
         choice_dum = fct_rev(first_choice_dum_1)) %>%
  glimpse()


```
```{r gg-three-wave}
  
gg_three_wave_df%>%
ggplot(aes(x = choice_dum, y = prop_strong, color = pid_3_1)) +
	geom_linerange(aes(ymin = prop_strong - 1.95*se_strong, ymax = prop_strong + 1.95*se_strong, color = pid_3_1)) +
  geom_line(aes(x = as.numeric(choice_dum), color = pid_3_1)) +
	geom_point(aes(shape = pid_3_1), size = 2) +
	geom_hline(yintercept = 0) +
	scale_color_manual(values = c("Democrat" = "dodgerblue3",
																"Republican" = "firebrick3")) +
	facet_wrap(vars(wave_norml)) +
	theme(legend.position = c(0.12, 0.2)) +
	coord_cartesian(ylim = c(-.25, .25)) +
	labs(title = "Change in Proportion of Strong Partisans",
			 subtitle = "Change Between Waves",
			 x = "Primary Vote Choice",
			 y = "Difference Between Waves",
			 color = "Party ID at Wave 1",
			 shape = "Party ID at Wave 1",
			 caption = "Bootstrapped 95% CIs") +
	scale_y_continuous(n.breaks = 10)

```


[FIGURE] shows the results of a three-wave-test of primary election outcome on strength of partisanship. Each point of the figure represents the change in the proportion of strong partisans present in each group between waves. The first panel shows the within-group change in strong partisanship between the two waves preceding the selection of a presumptive nominee in the relevant party's presidential primary. The second panel shows shows the change in strong partisanship within groups between the second (pre-treatment) wave and the third (post-treatment wave). The treatment in this case is the revelation of one candidate as the primary winner. Under this implementation of the three-wave-test, the average treatment effect (ATE) is calculated as the difference-in-difference in the proportion of strong partisans between winners and losers before and after the results of the primary election become clear:

$$[\mu(w)_{3} - \mu(l)_{2}]-[\mu(w)_{2} - \mu(l)_{1}]$$
where $\mu(w)_t$ is the proportion of strong partisans supporting a winning candidate at time $i$, $\mu(l)_t$ is the proportion of strong partisans supporting a losing candidate at time $t$ where all $t<3$ occurs pre-treatment and $t=3$ occurs post-treatment. A larger difference (a steeper slope) between winners and losers after the treatment is primed (after a presumptive nominee becomes apparent) suggests an effect of primary outcome on strength of partisanship.

Tests which compare only the pre and post treatment absolute value of a quantity are vulnerable to confounding pre-treatment effects [@lenz2013]. Analysis of cross-sectional data is unable to establish causal precedence---a situation in which cold partisans gravite towards ill-equipped primary candidates is observationally equivalent to one in which a primary loss causes individuals to dislike their party. By comparing the "effect" of a primary outcome before and after the outcome is known, unobserved pre-treatment differences are cancelled out.


## Survey Experiment


To gain further causal leverage over the question of primary election outcomes and partisans' affect, an original survey experiment is conducted, randomly assigning a primary election outcome to a counterfactual congressional primary election. The survey was programmed using the Qualtrics survey platform and participants were recruited using Amazon's *Mechanical Turk* (Mturk) platform.

### Experimental Design

[outline hypotheses for experiment]

The cross sectional 

After agreeing to partipate in the survey, subjects are asked to divulge their partisan affiliation. Subjects who self-identified as political independents were asked towards which party they tended to lean. Following the insight of @klar2016 that leaning independents are best understood as "secret partisans", leaning independents were coded as partisans of whichever party they indicated a preference towards. Those who did not indicate a preference were excluded from all subsequent analyses---while the attitudes and actions of these true independents are no doubt important, they fall outside the scope conditions of this investigation.

Next, participants were shown vignettes of two candidates and told that these candidates had competed against one another in a 2020 congressional primary election for the participant's party. The names of these candidates were drawn from a pool of Democratic and Republican candidates who had each participated in a congressional primary for an open seat in a district in which an out-party candidate eventually won election. In other words, none of the candidates whose names were used were members of congress during or after the 2020 election cycle. This set of names was chosen to minimize the chance of participants recognizing the candidates. Additionally, though it is unlikely that participants recruited through MTurk would seek out external information for a task, the use of general-election losing non-incumbents' names reduces the accessibility of official policy statements, platforms, or campaign materials.

In addition to candidates' names, the vignettes include basic personal information---party affiliation, occupation, marital status, and number of children---as well as a series of policy statements that participants were told "closely match the candidates' positions on a variety of issues." In reality, these policy positions were randomly assigned to each candidate from a set of two policy statements, one moderate and one extreme, across several issue areas. Republican respondents were shown statements on climate change, abortion, policing, and taxes. Democrats were shown statements reflecting the candidates' views on the Green New Deal, marijuana legalization, policing, and taxes. It was possible for candidates to take identical positions on any given issue and participants were informed of this in order to reduce confusion. The text of these statements can be read in this study's supporting information. Importantly, this study is not concerned with *why* participants preferred one candidate over the other, simply with how a chosen candidate's fate influences individuals' partisan identity and sense of political efficacy. These candidate vignettes are intended to provide enough information to participants so as to make the candidates appear credible, and to allow the participant to form a preference for a candidate through a variety of mechanisms. Candidates' personal information is included so that participants do not view the vignettes solely as a collection of policy statements, but as a summary of a real person seeking public office.

After reviewing the vignettes, participants are asked to "write a sentence or two explaining why [they] chose [their] candidate over the other". This free-response information is solicited from participants in order to slow down the participants' (who are often trying to complete tasks as quickly as possible) [CITE DOUG] thought and to increase the cognitive investment in their choice of candidate. Real world primary elections drag on for weeks and months while participants in this experiment are exposed to the candidates only for a few minutes.

After submitting their preferences, participants are randomly assigned to one of three groups. Those in "Loss" treatment are told that their preferred candidate was defeated in the primary, those in the "Win" treatment are told that their candidate won the primary and went on to compete in the general election. Participants in the control group were simply thanked for selecting a candidate. 

After receiving the treatment, participants were asked to rate the Democratic Party, Republican Party, and political independents on a feeling thermometer from 0-100. Participants were also asked a battery of political efficacy questions---how likely they would be to vote in the district's general election, the degree to which  they trust the federal government to do what is right, and the degree to which they are satisfied with the way democracy works in the United States. After answering these questions the participants are debriefed that the candidates' personal information and policy preferences do not necessarily reflect those of the actual candidate, at which point the experiment concludes.

In total, 473 participants were surveyed, of these only 18 identified as true independents, resulting in a final sample of $n = 455$. Summary statistics for these responses are presented in the table below.




```{r exp-wrangling, include = FALSE}

# Function to extract p from polr
tidy_custom.polr <- function(x, ...) {
	s <- coeftest(x)
	out <- data.frame(
		term = row.names(s),
		p.value = s[, "Pr(>|z|)"])
	out
}

# One-tailed coef test for LM

exp_df <- read_csv("data/raw/ap-experiment-08-22.csv")%>%
#	glimpse()#%>%
	select(StartDate,
#				 party_id...66,
				 party_id = party_id...18, #not sure why this is happening... something on the qtrix side of things. THis seems to be the correct pid variable.
					lean_party,
					d_loss,
					d_win,
					r_loss,
					r_win,
					control,
					therm_dem = therms_1,
					therm_rep = therms_2,
					therm_ind = therms_3,
					satisfied_democracy,
					trust_gov,
					r_gen_vote_loss:d_gen_vote_win_con,
				 comments)%>%
	.[-1,]%>%
	.[-1,]%>% #trimming off the label rows from qualtrics
	mutate(pid_3 = case_when(party_id != "Independent" & party_id != "Something Else" ~ party_id,
													 lean_party == "Neither Republican or Democrat" ~ "Independent",
													 lean_party == "Democratic" ~ "Democrat",
													 lean_party == "Republican" ~ "Republican",
													 lean_party == "Something Else" ~ "Independent",
													 TRUE ~ lean_party),
				 loss_dum = if_else(!is.na(d_loss) | !is.na(r_loss), 1, 0),
				 win_dum = if_else(!is.na(d_win) | !is.na(r_win), 1, 0),
				 control_dum = if_else(!is.na(control), 1, 0),
				 loss_dum_nc = if_else(control_dum == "1", NA_real_, loss_dum),
				 group = as.factor(case_when(loss_dum == "1" ~ "Loss",
				 									win_dum == "1" ~ "Win",
				 									control_dum == "1" ~ "Control")),
				 date = ymd_hms(StartDate),
				 therm_inparty = as.numeric(case_when(pid_3 == "Democrat" ~ therm_dem,
				 													pid_3 == "Republican" ~ therm_rep,
				 													TRUE ~ NA_character_)),
				 therm_outparty = as.numeric(case_when(pid_3 == "Democrat" ~ therm_rep,
				 																		 pid_3 == "Republican" ~ therm_dem,
				 																		 TRUE ~ NA_character_)),
				 vote_likely = factor(case_when(pid_3 == "Democrat" & group == "Loss" ~ d_gen_vote_loss,
				 												pid_3 == "Democrat" & group == "Win" ~ d_gen_vote_win_con,
				 												pid_3 == "Republican" & group == "Loss" ~ r_gen_vote_loss,
				 												pid_3 == "Republican" & group == "Win" ~ d_gen_vote_loss,
				 												TRUE ~ NA_character_),
				 										 levels = c("Extremely unlikely",
				 										 					 "Somewhat unlikely",
				 										 					 "Neither likely nor unlikely",
				 										 					 "Somewhat likely",
				 										 					 "Extremely likely")),
				 satisfied_democracy = factor(satisfied_democracy,
				 														 levels = c("Very Dissatisfied",
				 														 					 "Somewhat Dissatisfied",
				 														 					 "Neither Satisfied nor Dissatisfied",
				 														 					 "Somewhat Satisfied",
				 														 					 "Very Satisfied")),
				 trust_gov = factor(trust_gov,
				 									 levels = c("Not at all",
				 									 					 "A little",
				 									 					 "A moderate amount",
				 									 					 "A lot",
				 									 					 "A great deal")))%>%
	filter(date > ymd("2021-08-19"))%>%
#	filter(!is.na(group))%>%
	write_rds("data/tidy-exp.rds")%>%
#	filter(comments == "test")%>%
	glimpse()

group_df <- exp_df%>%
	filter(pid_3 != "Independent")%>%
	group_by(group,
					 pid_3)%>%
	summarize(ft_in = mean(therm_inparty),
						se_in = sd(therm_inparty)/sqrt(length(therm_inparty)),
						n = n())%>%
	glimpse()

m1 <- exp_df%>%
	filter(pid_3 != "Independent")%>%
	glimpse()
#	filter(pid_3 == "Republican")%>%



summary(m1)

m_df <- exp_df%>%
	filter(pid_3 != "Independent")%>%
	select(vote_likely,
				 therm_inparty,
				 therm_outparty,
				 therm_ind,
				 group,
				 loss_dum_nc,
				 satisfied_democracy,
				 trust_gov)

ggplot(m_df, aes(x = therm_inparty)) +
	geom_density() + 
	facet_wrap(vars(group))

```

## Experimental Results

To disentangle a *positive* effect of a primary victory from a *negative* effect of a primary loss, a series of simple regression analyses are performed, estimating partisan feeling thermometers as a function of two dummy variables indicating whether the participant's preferred candidate "won" or "lost" their primary bid. The control condition serves as the reference category in each model.

$$
[Therm] = Win + Loss
$$



The first model tests the effects of primary election loss and victory on in-party thermometer ratings. As expected, primary losers are colder towards their party than those who had no information about the primary's outcome. The relatively small effect size ($\hat{\beta} \approx -3.5$) is both unsurprising and unconcerning for the purposes of this study. The experimental treatment is likely much weaker than a real-world primary loss. Using this analysis to estimate a precise effect size of primary outcome on partisan affect would be inappropriate. Rather, the test should be taken more generally---as evidence that losing a primary decreases positive feelings for one's own party by some amount.


```{r therms-exp}

# In and outparty therms

cm_1 <- c("(Intercept)" = "Constant", "groupLoss" = "Loss", "groupWin" = "Win" )
gm_1 <- tibble::tribble(
	~raw,        ~clean,          ~fmt,
	"nobs",      "N",             0,)
#	"adj.r.squared", "Adj. R2", 2,
#	"r.squared" , "R2", 2)

mods <- tibble::tribble(~name, ~fit,
  "Inparty", lm(therm_inparty ~ group, data = m_df),
		 "Outparty", lm(therm_outparty ~ group, data = m_df),
		 "Independents", lm(therm_ind ~ group, data = m_df))

inparty <- lm(therm_inparty ~ group, data = m_df)


tidy_custom.lm <- function(x, ...) {
    s <- summary(x)$coefficients
    p <- broom::tidy(x)$p.value
    out <- data.frame(
      term = row.names(s),
      p.value = p/2) # returns p.value for one-tailed test.
    return(out)
}

list("Inparty" = lm(therm_inparty ~ group, data = m_df),
		 "Outparty" = lm(therm_outparty ~ group, data = m_df),
		 "Independents" = lm(therm_ind ~ group, data = m_df))%>%
	modelsummary(output = "gt",
							 stars = TRUE,
							 coef_map = cm_1,
							 gof_map = gm_1,
							 fmt = 2,
						 statistic = c("std.error", "p.value")) %>% 
  tab_header("Effect of Primary Outcome on Partisan Affect")


```

If primary outcomes affected partisans' appraisals of the political system more broadly we should expect to see complementary effects across attitudes towards groups beyond participants' in-party, as observed in the cross-sectional primary election data analyses [cite figs]. No such effects are observed. Under these experimental conditions primary outcomes do not appear to affect attitudes towards independents or the out-party. The partisan disdain hypothesis is therefore unsupported by this experiment. 


A

```{r political-efficacy-exp, fig.cap="test"}

# comparing Winners and Losers Political Optimism
cm_2 <- c("loss_dum_nc" = "Primary Loss"
#          "therm_inparty" = "Therm. In-party",
#          "therm_outparty" = "Therm. Out-party"
)
gm_2 <- tibble::tribble(
	~raw,        ~clean,          ~fmt,
	"nobs",      "N",             0,
	"AIC", "AIC", 2,
	"logLik" , "Log Likelihood", 2,
	"chi.sq", "Chi Sq.", 2)

list("Vote General" = MASS::polr(vote_likely ~ loss_dum_nc, data = m_df, Hess = TRUE),
			 "Trust Gov." = MASS::polr(trust_gov ~ loss_dum_nc , data = m_df, Hess = TRUE),
			 "Democ. Satisfaction" = MASS::polr(satisfied_democracy ~ loss_dum_nc, method = "logistic", data = m_df, Hess = TRUE))%>%
modelsummary(output = "gt",
             coef_map = cm_2,
						 gof_map = gm_2,
						 stars = TRUE,
						 title = "Differences in Political Efficacy Between Primary Winners and Losers")
```

Next, I compare primary winners to primary losers on three political efficacy items---self-reported likelihood of voting in a general election, satisfaction with democracy, and trust in government---testing the hypothesis that those who support a losing candidate will exhibit lower political efficacy, being less likely to cast a vote, less trusting of government, and less satisfied with democracy. Each of these items were asked of respondents in the ANES-CDF, estimations of the population-level differences between cold and warm partisans on these three dimensions are included in the "Opinion" section of Figure 4.

In the Mturk experiment those in the "Win" and "Loss" groups are asked to rate their likelihood of voting in the general election, level of trust in the United States government, and overall satisfaction with democracy on five point scales, where low (high) values indicate lower (higher) likelihood of voting, trust, and satisfaction. Respondents were allowed to respond in a neutral manner for each question.

Table [NUMBER] shows the result of three ordered logistic regression analyses where $\textit{Primary Loss} = 1$ indicates that the participant belonged to the "Loss" condition. Those for whom $\textit{Primary Loss} = 0$ belong to the win condition. Though the lack of control group responses for these questions preclude the possibility of isolating a treatment effect---the decision to treat winners as the reference category is arbitrary---assignment to either group remains random. Because $\textit{Primary Loss}$ is assigned randomly across participants any difference between winners and loser can be attributed either to $\textit{Primary Loss}$ or to chance, any unobserved covariates having been controlled for through randomization.

As shown in Table [NUMBER], primary losers were less likely than winners to vote and expressed less trust towards the government. Somewhat surprisingly, there was no statistically significant difference between winners' and losers' reported satisfaction with democracy. This may be reassuring to some observers who worry that primary elections undermine faith in democratic institutions [@azari2017], or the lack of a significant difference may simply be a product of an intentionally conservative (or less charitably, weak) treatment. Perhaps the loss of a paper candidate in an unidentified congressional district is not enough to shake Americans' faith in Democracy, but a more tangible defeat may be.



# Conclusion



\clearpage
# References







